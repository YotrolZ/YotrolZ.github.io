<!DOCTYPE html>
<html lang="en">
  <head><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<link rel="alternate" href="/atom.xml" title="YotrolZ" type="application/atom+xml"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.11.0" />
<link rel="canonical" href="http://yotrolz.com/page/2/"/>

<link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" />
<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.11.0" />

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-138610487-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-138610487-3');
</script><script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<script>
  window.config = {"leancloud":{"app_id":null,"app_key":null},"toc":true,"fancybox":true,"pjax":"","latex":false};
</script>

    <title>YotrolZ</title>
  <meta name="generator" content="Hexo 5.2.0"></head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">YotrolZ</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list"><a href="/">
        <li class="mobile-menu-item">Home
          </li>
      </a><a href="/archives/">
        <li class="mobile-menu-item">Archives
          </li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags
          </li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories
          </li>
      </a></ul>
</nav>
<div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">YotrolZ</a>
</div>

<nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item">
          <a class="menu-item-link" href="/">
            Home
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            Archives
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/tags/">
            Tags
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/categories/">
            Categories
            </a>
        </li>
      </ul></nav>
</header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content"><section id="posts" class="posts"><article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/posts/3fd3799f/">设计模式04--建造者模式(iOS)</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2018-01-02
        </span></div>
    </header>

    <div class="post-content"><blockquote>
<p><strong>1、建造者模式简述</strong></p>
</blockquote>
<ul>
<li><code>建造者模式</code>(Builder)，又叫<code>生成器模式</code>将一个<code>复杂对象</code>的构建与它的表示分离，使得<code>同样的构建过程</code>可以创建<code>不同的表示</code>；</li>
<li>如果使用了建造者模式，用户就只需要指定需要构建的类型，而具体的构建细节无需知道。</li>
</ul>
<blockquote>
<p><strong>2、建造者模式角色划分</strong></p>
</blockquote>
<ul>
<li><p><strong>抽象建造者：Builder</strong></p>
<ul>
<li>为创建一个Product对象的各个部分指定抽象接口；</li>
<li>一般至少会有两个抽象方法，一个用来建造产品，一个是用来返回产品。</li>
</ul>
</li>
<li><p><strong>具体建造者：ConcreteBuilder</strong></p>
<ul>
<li>实现抽象建造者的接口，具体的去构建各个部分；</li>
</ul>
</li>
<li><p><strong>具体产品：Product</strong></p>
<ul>
<li>就是我们所需要的具体产品；</li>
<li>由多个部件组成；</li>
</ul>
</li>
<li><p><strong>指挥者：Director</strong></p>
<ul>
<li>负责调用适当的建造者来构建我们需要的产品；</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>3、建造者模式UML类图</strong></p>
</blockquote>
<ul>
<li><img src="http://upload-images.jianshu.io/upload_images/590107-2b0ef7a4f4c3410f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="建造者模式"></li>
</ul>
<blockquote>
<p><strong>4、建造者模式示意代码</strong></p>
</blockquote>
<ul>
<li><p><strong>抽象建造者：<code>YAbsComputerBuilder</code></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">@protocol YAbsComputerBuilder &lt;NSObject&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;** 构建主板 *&#x2F;</span><br><span class="line">- (void)buildMainboard;</span><br><span class="line"></span><br><span class="line">&#x2F;** 构建处理器 *&#x2F;</span><br><span class="line">- (void)buildCPU;</span><br><span class="line"></span><br><span class="line">&#x2F;** 构建显卡 *&#x2F;</span><br><span class="line">- (void)buildGPU;</span><br><span class="line"></span><br><span class="line">&#x2F;** 构建内存 *&#x2F;</span><br><span class="line">- (void)buildMemoryDisk;</span><br><span class="line"></span><br><span class="line">&#x2F;** 构建硬盘 *&#x2F;</span><br><span class="line">- (void)buildHardDisk;</span><br><span class="line"></span><br><span class="line">&#x2F;** 构建显示器 *&#x2F;</span><br><span class="line">- (void)buildDisplay;</span><br><span class="line"></span><br><span class="line">&#x2F;** 获取构建好的具体产品 *&#x2F;</span><br><span class="line">- (YComputer *)getBuidResult;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>具体建造者：ConcreteBuilder</strong></p>
<ul>
<li><p>普通电脑建造者：**<code>YNormalComputerBuilder</code>**</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">@implementation YNormalComputerBuilder</span><br><span class="line">&#123;</span><br><span class="line">    YComputer *_computer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (instancetype)init &#123;</span><br><span class="line">    if (self &#x3D; [super init]) &#123;</span><br><span class="line">        _computer &#x3D; [[YComputer alloc] init];</span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;** 构建主板 *&#x2F;</span><br><span class="line">- (void)buildMainboard &#123;</span><br><span class="line">    _computer.mainboard &#x3D; @&quot;技嘉 H110M-DS2V主板&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;** 构建处理器 *&#x2F;</span><br><span class="line">- (void)buildCPU &#123;</span><br><span class="line">    _computer.cpu &#x3D; @&quot;intel i3处理器&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;** 构建显卡 *&#x2F;</span><br><span class="line">- (void)buildGPU &#123;</span><br><span class="line">    _computer.gpu &#x3D; @&quot;集成显卡&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;** 构建内存 *&#x2F;</span><br><span class="line">- (void)buildMemoryDisk &#123;</span><br><span class="line">    _computer.memoryDisk &#x3D; @&quot;金士顿 4G内存&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;** 构建硬盘 *&#x2F;</span><br><span class="line">- (void)buildHardDisk &#123;</span><br><span class="line">    _computer.hardDisk &#x3D; @&quot;500G 机械硬盘&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;** 构建显示器 *&#x2F;</span><br><span class="line">- (void)buildDisplay &#123;</span><br><span class="line">    _computer.display &#x3D; @&quot;13存 2K显示器&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (YComputer *)getBuidResult &#123;</span><br><span class="line">    return _computer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>高配电脑建造者：**<code>YAdvancedComputerBuilder</code>**</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">@implementation YAdvancedComputerBuilder</span><br><span class="line">&#123;</span><br><span class="line">    YComputer *_computer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (instancetype)init &#123;</span><br><span class="line">    if (self &#x3D; [super init]) &#123;</span><br><span class="line">        _computer &#x3D; [[YComputer alloc] init];</span><br><span class="line">     &#125;</span><br><span class="line">    return self;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;** 构建主板 *&#x2F;</span><br><span class="line">- (void)buildMainboard &#123;</span><br><span class="line">    _computer.mainboard &#x3D; @&quot;技嘉 X299 UD4主板&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;** 构建处理器 *&#x2F;</span><br><span class="line">- (void)buildCPU &#123;</span><br><span class="line">    _computer.cpu &#x3D; @&quot;intel i9处理器&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;** 构建显卡 *&#x2F;</span><br><span class="line">- (void)buildGPU &#123;</span><br><span class="line">    _computer.gpu &#x3D; @&quot;GTX1080显卡&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;** 构建内存 *&#x2F;</span><br><span class="line">- (void)buildMemoryDisk &#123;</span><br><span class="line">    _computer.memoryDisk &#x3D; @&quot;金士顿 16G内存&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;** 构建硬盘 *&#x2F;</span><br><span class="line">- (void)buildHardDisk &#123;</span><br><span class="line">    _computer.hardDisk &#x3D; @&quot;1T 固态硬盘&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;** 构建显示器 *&#x2F;</span><br><span class="line">- (void)buildDisplay &#123;</span><br><span class="line">    _computer.display &#x3D; @&quot;27存 4K显示器&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (YComputer *)getBuidResult &#123;</span><br><span class="line">    return _computer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><strong>具体产品：<code>YComputer</code></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@interface YComputer : NSObject</span><br><span class="line"></span><br><span class="line">@property (nonatomic, copy)NSString *mainboard;  &#x2F;&#x2F;!&lt; 主板</span><br><span class="line">@property (nonatomic, copy)NSString *cpu;        &#x2F;&#x2F;!&lt; 处理器</span><br><span class="line">@property (nonatomic, copy)NSString *gpu;        &#x2F;&#x2F;!&lt; 显卡</span><br><span class="line">@property (nonatomic, copy)NSString *memoryDisk; &#x2F;&#x2F;!&lt; 内存</span><br><span class="line">@property (nonatomic, copy)NSString *hardDisk;   &#x2F;&#x2F;!&lt; 硬盘</span><br><span class="line">@property (nonatomic, copy)NSString *display;    &#x2F;&#x2F;!&lt; 显示器</span><br><span class="line"></span><br><span class="line">&#x2F;** 用于展示商品 *&#x2F;</span><br><span class="line">- (void)show;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">@implementation YComputer</span><br><span class="line"></span><br><span class="line">- (void)show &#123;</span><br><span class="line">    NSLog(@&quot;&lt;&lt;&lt;&lt;电脑的配置单&gt;&gt;&gt;&gt;&quot;);</span><br><span class="line">    NSLog(@&quot;主板:  %@&quot;, self.mainboard);</span><br><span class="line">    NSLog(@&quot;CPU:  %@&quot;, self.cpu);</span><br><span class="line">    NSLog(@&quot;GPU:  %@&quot;, self.gpu);</span><br><span class="line">    NSLog(@&quot;内存:  %@&quot;, self.memoryDisk);</span><br><span class="line">    NSLog(@&quot;硬盘:  %@&quot;, self.hardDisk);</span><br><span class="line">    NSLog(@&quot;显示器: %@\n&quot;, self.display);</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>指挥者：<code>YComputerDirector</code></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@interface YComputerDirector : NSObject</span><br><span class="line"></span><br><span class="line">- (void)constructWithBuilder:(id &lt;YAbsComputerBuilder&gt;)builder;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Client</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 指挥者</span><br><span class="line">YComputerDirector *director &#x3D; [[YComputerDirector alloc] init];</span><br><span class="line">  </span><br><span class="line">&#x2F;&#x2F; 建造者</span><br><span class="line">YNormalComputerBuilder *normalBuilder &#x3D; [[YNormalComputerBuilder alloc] init];</span><br><span class="line">YAdvancedComputerBuilder *advBuilder &#x3D; [[YAdvancedComputerBuilder alloc] init];</span><br><span class="line">  </span><br><span class="line">&#x2F;&#x2F; &lt;普通电脑&gt;装配、构建</span><br><span class="line">[director constructWithBuilder:normalBuilder];</span><br><span class="line">&#x2F;&#x2F; 具体产品</span><br><span class="line">YComputer *normalComputer &#x3D; [normalBuilder getBuidResult];</span><br><span class="line">&#x2F;&#x2F; 展示产品</span><br><span class="line">[normalComputer show];</span><br><span class="line">  </span><br><span class="line">&#x2F;&#x2F; &lt;高配电脑&gt;装配、构建</span><br><span class="line">[director constructWithBuilder:advBuilder];</span><br><span class="line">&#x2F;&#x2F; 具体产品</span><br><span class="line">YComputer *advComputer &#x3D; [advBuilder getBuidResult];</span><br><span class="line">&#x2F;&#x2F; 展示产品</span><br><span class="line">[advComputer show];</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 运行结果：</span><br><span class="line">&lt;&lt;&lt;&lt;电脑配置单&gt;&gt;&gt;&gt;</span><br><span class="line">主板:  技嘉 H110M-DS2V主板</span><br><span class="line">CPU:  intel i3处理器</span><br><span class="line">GPU:  集成显卡</span><br><span class="line">内存:  金士顿 4G内存</span><br><span class="line">硬盘:  500G 机械硬盘</span><br><span class="line">显示器: 13存 2K显示器</span><br><span class="line"></span><br><span class="line">&lt;&lt;&lt;&lt;电脑配置单&gt;&gt;&gt;&gt;</span><br><span class="line">主板:  技嘉 X299 UD4主板</span><br><span class="line">CPU:  intel i9处理器</span><br><span class="line">GPU:  GTX1080显卡</span><br><span class="line">内存:  金士顿 16G内存</span><br><span class="line">硬盘:  1T 固态硬盘</span><br><span class="line">显示器: 27存 4K显示器</span><br></pre></td></tr></table></figure>


</li>
</ul>
<blockquote>
<p><strong>5、建造者模式总结</strong></p>
</blockquote>
<ul>
<li><p>优点：</p>
<ul>
<li>使用建造者模式可以使客户端不必知道产品内部的构建细节；</li>
<li>Builder之间是相互独立的，与其它的Builder无关，便于系统的扩展；</li>
</ul>
</li>
<li><p>与**<code>工厂模式</code>**的区别：</p>
<ul>
<li><p>建造者模式比工厂模式多了一个指挥者(Direcitor)角色；</p>
</li>
<li><p>意图不同：</p>
<ul>
<li><p><strong>工厂模式</strong>：关注的是产品整体；我们需要什么产品，共产就给我我们什么产品；</p>
</li>
<li><p><strong>建造者模式</strong>：关注的是产品组成部分的构建过程；将一个复杂对象的构建与它的表示分离，使得同样的构建过程可以创建不同的表示，而调用者不需要知道这些细节；</p>
</li>
<li><p>产品复杂度不同：</p>
<ul>
<li><strong>工厂模式</strong>：一般都是单一性质产品；</li>
<li><strong>建造者模式</strong>：复合型产品；它由各个部件组合而成，部件不同造成的产品也截然不同；</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/YotrolZ/DesignPatterns-OC">完整Demo</a></p>
</li>
</ul>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/posts/aea66cc7/">设计模式03--抽象工厂模式(iOS)</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2017-12-25
        </span></div>
    </header>

    <div class="post-content"><blockquote>
<p><strong>0、序</strong></p>
</blockquote>
<ul>
<li>在上一篇文章<a target="_blank" rel="noopener" href="http://www.jianshu.com/p/ec97eb083fe1">《工厂方法模式》</a>中，我们定义了奥迪工厂<code>AudiFactory</code> 生产出来的就是<code>奥迪汽车</code>和 奔驰工厂<code>BenzFactory</code>生产出来的就是<code>奔驰汽车</code>，但是随着其发展，奥迪工厂不仅仅生产一种车了，而是生产种种系列车型，比如有SUV系列产品与MPV系列产品，那么此时我们的<code>AudiFactory</code> 就不能满足需求了，那么该怎么办呢？</li>
<li><code>抽象工厂模式</code>正好能解决上面的问题，让我们一起来看看抽象工厂。</li>
<li>在之前我们先记住上面的一个词<code>系列产品</code>；</li>
</ul>
<blockquote>
<p><strong>1、抽象工厂模式简述</strong></p>
</blockquote>
<ul>
<li><p>对一组具有<code>相同主题</code>的工厂进行封装</p>
<ul>
<li>以上面的汽车为例，在抽象工厂模式中，会有SUV工厂和MPV工厂，还有一个大的抽象工厂，里面涵盖了SUV工厂和MPV工厂所有能做的事情。<ul>
<li>上面所说的SUV工厂、MPV工厂其实都是可以生产一系列产品的(SUV汽车或者MPV汽车)，也就是<code>产品族</code>的概念。而在工厂方法模式中，其工厂生产出来的产品是属于同一个<code>产品等级</code>(比如：不同厂商生产的汽车-奥迪汽车和奔驰汽车)。</li>
</ul>
</li>
</ul>
<ul>
<li><img src="http://upload-images.jianshu.io/upload_images/590107-302923e38efaae11.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="相图"></li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>2、抽象工厂模式角色划分</strong></p>
</blockquote>
<ul>
<li><p><strong>抽象工厂</strong></p>
<ul>
<li>抽象类，内部提供了所有工厂的接口</li>
</ul>
</li>
<li><p><strong>具体工厂</strong></p>
<ul>
<li>具体工厂：可生产所有的系列产品(<code>产品族</code>)；</li>
</ul>
</li>
<li><p><strong>产品系列A</strong></p>
<ul>
<li>抽象产品A：内部提供了A系列产品的共有功能；</li>
<li>具体产品A：A系列具体的单个产品;</li>
<li><em>注：当然，还有A系列的其他的产品，它们属于同一个<code>产品等级</code></em>;</li>
</ul>
</li>
<li><p><strong>产品系列B</strong></p>
<ul>
<li>抽象产品B：内部提供了B系列产品的共有功能；</li>
<li>具体产品B：B系列具体的单个产品；</li>
<li>*<strong>注</strong>：当然，还有B系列的其他的产品，它们属于同一个<code>产品等级</code>*;</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>3、抽象工厂模式UML类图</strong></p>
</blockquote>
<ul>
<li><img src="http://upload-images.jianshu.io/upload_images/590107-304930132fb19d52.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="抽象工厂模式"></li>
</ul>
<blockquote>
<p><strong>4、抽象工厂模式示意代码</strong></p>
</blockquote>
<ul>
<li><p><strong>抽象工厂: <code>YCarAbsFactory</code></strong></p>
<ul>
<li>内部提供了所有工厂的接口<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@protocol YCarAbsFactory &lt;NSObject&gt;</span><br><span class="line">+ (id&lt;YSuvCar&gt;)creatSuvCar; &#x2F;&#x2F; 创建SUV系列的车</span><br><span class="line">+ (id&lt;YMpvCar&gt;)creatMpvCar; &#x2F;&#x2F; 创建MPV系列的车</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><strong>具体工厂</strong></p>
<ul>
<li>具体工厂1：<code>YAudiCarFactory</code>：可生产所有的系列产品(<code>产品族</code>)；<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@implementation YAudiCarFactory</span><br><span class="line">+ (id&lt;YSuvCar&gt;)creatSuvCar &#123; </span><br><span class="line">    return [[YAudiSuvCar alloc] init]; &#x2F;&#x2F; 创建具体的奥迪SUV</span><br><span class="line">&#125;</span><br><span class="line">+ (id&lt;YMpvCar&gt;)creatMpvCar &#123;</span><br><span class="line">    return [[YAudiMpvCar alloc] init]; &#x2F;&#x2F; 创建具体的奥迪MPV</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure></li>
<li>具体工厂2：<code>YBenzCarFactory</code>：可生产所有的系列产品(<code>产品族</code>)；</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@implementation YBenzCarFactory</span><br><span class="line">+ (id&lt;YSuvCar&gt;)creatSuvCar &#123;</span><br><span class="line">    return [[YBenzSuvCar alloc] init];  &#x2F;&#x2F; 创建具体的奔驰SUV</span><br><span class="line">&#125;</span><br><span class="line">+ (id&lt;YMpvCar&gt;)creatMpvCar &#123;</span><br><span class="line">    return [[YBenzMpvCar alloc] init]; &#x2F;&#x2F; 创建具体的奔驰MPV</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<ul>
<li>*<strong>补充：</strong>可能还会有一个具体工厂3，比如：宝马工厂*，宝马工厂同样能生产SUV的车和MPV的车，并且根据需要在内部实现创建具体的产品逻辑；</li>
</ul>
</li>
<li><p><strong>产品系列A</strong></p>
<ul>
<li>抽象产品：<code>YSuvCar</code>：内部提供了A系列产品的共有功能；<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@protocol YSuvCar &lt;NSObject&gt;</span><br><span class="line">- (void)suvRun;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure></li>
<li>具体产品a1：<code>YAudiSuvCar</code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@implementation YAudiSuvCar</span><br><span class="line">- (void)suvRun &#123;</span><br><span class="line">    NSLog(@&quot;奥迪SUV跑起来了&quot;);</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure></li>
<li>具体产品a2：<code>YBenzSuvCar</code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@implementation YBenzSuvCar</span><br><span class="line">- (void)suvRun &#123;</span><br><span class="line">    NSLog(@&quot;奔驰SUV跑起来了&quot;);</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure></li>
<li><strong>注</strong>：上面的a1、a2属于同一个**<code>产品族</code><strong>(SUV车系)的不同</strong><code>产品等级</code>**(奥迪、奔驰)；</li>
</ul>
</li>
</ul>
<ul>
<li><p><strong>产品系列B</strong></p>
<ul>
<li><p>抽象产品B：<code>YMpvCar</code>：内部提供了B系列产品的共有功能；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@protocol YMpvCar &lt;NSObject&gt;</span><br><span class="line">- (void)mpvRun;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
</li>
<li><p>具体产品b1：<code>YAudiMpvCar</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@implementation YAudiMpvCar</span><br><span class="line">- (void)mpvRun &#123;</span><br><span class="line">    NSLog(@&quot;奥迪MPV跑起来了&quot;);</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure></li>
<li><p>具体产品b2：<code>YBenzMpvCar</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@implementation YBenzMpvCar</span><br><span class="line">- (void)mpvRun &#123;</span><br><span class="line">    NSLog(@&quot;奔驰MPV跑起来了&quot;);</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure></li>
<li><p><strong>注</strong>：上面的b1、b2属于同一个**<code>产品族</code><strong>(MPV车系)的不同</strong><code>产品等级</code>**(奥迪、奔驰)；</p>
</li>
</ul>
</li>
<li><p><strong>Client使用</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; 奥迪SUV</span><br><span class="line">id&lt;YSuvCar&gt; audiSuv &#x3D; [YAudiCarFactory creatSuvCar];</span><br><span class="line">[audiSuv suvRun];</span><br><span class="line">&#x2F;&#x2F; 奥迪MPV</span><br><span class="line">id&lt;YMpvCar&gt; audiMpv &#x3D; [YAudiCarFactory creatMpvCar];</span><br><span class="line">[audiMpv mpvRun];</span><br><span class="line">  </span><br><span class="line">&#x2F;&#x2F; 奔驰SUV</span><br><span class="line">id&lt;YSuvCar&gt; benzSuv &#x3D; [YBenzCarFactory creatSuvCar];</span><br><span class="line">[benzSuv suvRun];</span><br><span class="line">&#x2F;&#x2F; 奔驰MPV</span><br><span class="line">id&lt;YMpvCar&gt; benzMpv &#x3D; [YBenzCarFactory creatMpvCar];</span><br><span class="line">[benzMpv mpvRun];</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 运行结果：</span><br><span class="line">奥迪SUV跑起来了</span><br><span class="line">奥迪MPV跑起来了</span><br><span class="line">奔驰SUV跑起来了</span><br><span class="line">奔驰MPV跑起来了</span><br></pre></td></tr></table></figure>

</li>
</ul>
<blockquote>
<p><strong>5、抽象工厂模式与工厂方法模式对比</strong></p>
</blockquote>
<table>
<thead>
<tr>
<th>工厂方法模式</th>
<th>抽象工厂模式</th>
</tr>
</thead>
<tbody><tr>
<td>工厂类一般只有一个方法，创建一种产品</td>
<td>工厂类有多个方法，创建多系列产品</td>
</tr>
<tr>
<td>只涉及产品等级</td>
<td>涉及产品等级与产品族</td>
</tr>
<tr>
<td>增加子类即可添加新产品</td>
<td>必须修改父类接口才能添加新产品</td>
</tr>
</tbody></table>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/YotrolZ/DesignPatterns-OC">完整Demo</a></li>
</ul>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/posts/5acc72a0/">设计模式02--工厂方法模式(iOS)</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2017-12-20
        </span></div>
    </header>

    <div class="post-content"><blockquote>
<p> <strong>0、序</strong></p>
</blockquote>
<ul>
<li><p>在<a target="_blank" rel="noopener" href="http://www.jianshu.com/p/914cc0695941">简单工厂模式</a>中，我们总结了简单工厂模式的优缺点，如下：</p>
<ul>
<li><p>优点</p>
<ul>
<li>工厂类内部含有创建具体产品的逻辑，外界只需要向工厂类请求所需的产品即可，不需要关心产品实现细节；</li>
</ul>
</li>
<li><p>缺点</p>
<ul>
<li>工厂类内部集中了创建具体产品的逻辑，假如我们需要新添加一种产品，就要修改工厂类，进行参数判断，<code>无法使用其子类继承进行扩展</code>。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>所以<code>工厂方法模式</code>出现了。</p>
<blockquote>
<p><strong>1、工厂方法模式简述</strong></p>
</blockquote>
<ul>
<li>简而言之就是，将<code>简单工厂模式</code>中的<code>工厂类</code>继续抽象。</li>
</ul>
<blockquote>
<p><strong>2、工厂方法模式角色划分</strong></p>
</blockquote>
<ul>
<li><p><strong>抽象工厂</strong></p>
<ul>
<li>从工厂类中抽象出来一个接口，这个接口只有一个方法，也就是用于<code>创建抽象产品的工厂方法</code>，用<code>抽象类</code>表示，由于OC中无抽象类的概念，使用<code>协议（Protocol）</code>来表示；</li>
</ul>
</li>
<li><p><strong>具体工厂</strong></p>
<ul>
<li>负责生产具体的产品；</li>
</ul>
</li>
<li><p><strong>抽象产品</strong></p>
<ul>
<li>工厂中要返回的产品，用<code>抽象类</code>表示，由于OC中无抽象类的概念，使用<code>协议（Protocol）</code>来表示；</li>
</ul>
</li>
<li><p><strong>具体产品</strong></p>
<ul>
<li>供外界使用的具体的产品；</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>3、工厂方法模式UML类图</strong></p>
</blockquote>
<ul>
<li><img src="http://upload-images.jianshu.io/upload_images/590107-df1700fe3745c9df.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="工厂方法模式"></li>
</ul>
<blockquote>
<p><strong>4、工厂方法模式示意代码</strong></p>
</blockquote>
<ul>
<li><p>抽象产品：<code>YCar</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@protocol YCar &lt;NSObject&gt;</span><br><span class="line">- (void)run;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
</li>
<li><p>具体产品： <code>YAudi</code>、<code>YBenz</code></p>
<ul>
<li>.h文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@interface YAudi : NSObject &lt;YCar&gt;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@interface YBenz : NSObject &lt;YCar&gt;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure></li>
<li>.m文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@implementation YAudi</span><br><span class="line">- (void)run &#123;</span><br><span class="line">    NSLog(@&quot;奥迪车跑起来了&quot;);</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation YBenz</span><br><span class="line">- (void)run &#123;</span><br><span class="line">    NSLog(@&quot;奔驰车跑起来了&quot;);</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>抽象工厂：<code>YAbsFactory</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@protocol YAbsFactory &lt;NSObject&gt;</span><br><span class="line">+ (id&lt;YCar&gt;)creatCar; </span><br><span class="line">@end</span><br></pre></td></tr></table></figure></li>
<li><p>具体工厂：<code>YAudiFactory</code>、<code>YBenzFactory</code></p>
<ul>
<li>.h文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> &#x2F;&#x2F; Audi汽车工厂</span><br><span class="line">@interface YAudiFactory : NSObject &lt;YAbsFactory&gt;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; Benz汽车工厂</span><br><span class="line">@interface YBenzFactory : NSObject &lt;YAbsFactory&gt;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure></li>
<li>.m文件<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@implementation YAudiFactory</span><br><span class="line">+ (id&lt;YCar&gt;)creatCar &#123;</span><br><span class="line">  return [[YAudi alloc] init]; &#x2F;&#x2F; 生产Audi汽车</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation YBenzFactory</span><br><span class="line">+ (id&lt;YCar&gt;)creatCar &#123;</span><br><span class="line">    return [[YBenz alloc] init]; &#x2F;&#x2F; 生产Benz汽车</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>Client使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">id&lt;YCar&gt; car1 &#x3D; [YAudiFactory creatCar];</span><br><span class="line">[car1 run];</span><br><span class="line">  </span><br><span class="line">id&lt;YCar&gt; car2 &#x3D; [YBenzFactory creatCar];</span><br><span class="line">[car2 run];</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 运行结果：</span><br><span class="line">奥迪车跑起来了</span><br><span class="line">奔驰车跑起来了</span><br></pre></td></tr></table></figure>
</li>
<li><p>扩展：新加的需求一辆保时捷轿车</p>
<ul>
<li>创建保时捷汽车具体产品类：<code>YPorsche</code>，遵守<code>Ycar</code>协议；</li>
<li>创建保时捷汽车具体工厂类：<code>YPorscheFactory</code>，遵守<code>YAbsFactory</code>协议，实现<code>+ (id&lt;YCar&gt;)creatCar</code>工厂方法，内部创建一个具体的保时捷汽车(YPorsche实例)；</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>5、工厂方法模式总结</strong></p>
</blockquote>
<ul>
<li><p>工厂方法模式就是将工厂类抽象出一个接口(抽象工厂类)，接口内只有一个方法，也就是创建<code>抽象产品</code>的方法，然后使其子类具体工厂去创建具体的产品；</p>
</li>
<li><p>与简单工厂的区别：(需要新添加别的具体产品的场景)</p>
<ul>
<li>简单工厂模式：需要修改工厂方法，添加参数进行判断；</li>
<li>工厂方法模式：不需要修改工厂方法，只需添加新的具体产品类和生产这个具体产品的具体工厂类；</li>
</ul>
</li>
<li><p><a target="_blank" rel="noopener" href="https://github.com/YotrolZ/DesignPatterns-OC">完整Demo</a></p>
</li>
</ul>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/posts/c9e7b927/">UML图中类之间的关系(iOS）</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2017-12-12
        </span></div>
    </header>

    <div class="post-content"><ul>
<li>在UML类图中常见的有以下几种关系: <code>泛化(Generalization)</code>、<code>实现(Realization)</code>、<code>组合(Composition)</code>、<code>聚合(Aggregation)</code>、<code>关联(Association)</code>、<code>依赖(Dependency)</code>。</li>
<li>各种关系的强弱顺序：<br>　　泛化 = 实现 &gt; 组合 &gt; 聚合 &gt; 关联 &gt; 依赖</li>
</ul>
<blockquote>
<p><strong>1、泛化(Generalization)关系</strong></p>
</blockquote>
<ul>
<li><p>关系简述:</p>
<ul>
<li><code>is-a</code>关系。</li>
<li><code>泛化关系</code>是一种<code>继承关系</code>，用于描述父类与子类之间的关系。例如：<code>学生</code>属于<code>人类</code>，他即有学生的特性也有人类的共性。  </li>
</ul>
</li>
<li><p>关系图形：</p>
<ul>
<li>带空心三角箭头的实线，箭头指向父类。<img src="http://upload-images.jianshu.io/upload_images/590107-c68df27417e7827f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="泛化关系"></li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>2、实现(Realization)关系</strong></p>
</blockquote>
<ul>
<li><p>关系简述</p>
<ul>
<li>实现关系是一种类与接口的关系，表示类是接口所有特征和行为的实现，在这种关系中，类实现了接口，类中的操作实现了接口中所声明的操作</li>
</ul>
</li>
<li><p>关系图形</p>
<ul>
<li>带空心三角箭头的虚线，箭头指向接口。<img src="http://upload-images.jianshu.io/upload_images/590107-337b381d9b469173.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="实现关系"></li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>3、组合(Composition)关系</strong></p>
</blockquote>
<ul>
<li><p>关系简述：</p>
<ul>
<li><code>contains-a</code>关系。</li>
<li>整体与部分的关系，但是整体与部分<code>不可以分开</code>。</li>
<li>组合关系中部分和整体具有统一的生存期。一旦整体对象不存在，部分对象也将不存在，部分对象与整体对象之间具有<code>同生共死</code>的关系。</li>
</ul>
</li>
<li><p>关系图形：</p>
<ul>
<li>带实心菱形的直线，菱形指向整体。<img src="http://upload-images.jianshu.io/upload_images/590107-1a598cc7cdb44f47.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="组合关系"></li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>4、聚合(Aggregation)关系</strong></p>
</blockquote>
<ul>
<li>关系简述：<ul>
<li><code>has-a</code>关系。</li>
<li>整体和部分的关系，整体与部分<code>可以分开</code>。</li>
<li>他们可以具有各自的生命周期。</li>
</ul>
</li>
</ul>
<ul>
<li>关系图形：<ul>
<li>带空心菱形的直线，菱形指向整体。<img src="http://upload-images.jianshu.io/upload_images/590107-c924b7fb6b293c3c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="聚合关系"></li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>5、关联(Association)关系</strong></p>
</blockquote>
<ul>
<li><p>关系简述：</p>
<ul>
<li>一种拥有的关系，它使一个类知道另一个类的属性和方法，通常将一个类的对象作为另一个类的属性。</li>
<li>分为<code>单向关联</code>、<code>双向关联</code>。</li>
<li>关联有两个端点，在每个端点可以有一个基数，表示这个关联的类可以有几个实例。</li>
</ul>
</li>
<li><p>常见的基数及含义: </p>
<ul>
<li><code>0..1</code>表示0 或一个实例。</li>
<li><code>0..*</code>表示对实例的数目没有限制。</li>
<li><code>1</code>表示只能有一个实例。</li>
<li><code>1..*</code>表示至少有一个实例。 </li>
</ul>
</li>
<li><p>关系图形：</p>
<ul>
<li>带普通箭头的实心线，指向被拥有者。</li>
<li>双箭头或不使用箭头表示双向关联。</li>
<li>单箭头表示单向关联。<img src="http://upload-images.jianshu.io/upload_images/590107-899052c9a3b28421.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="关联关系"></li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>6、依赖(dependency)关系</strong></p>
</blockquote>
<ul>
<li><p>关系简述：</p>
<ul>
<li>是一种<code>使用关系</code>，表示一个类依赖于另一个类的定义。</li>
<li>依赖关系总是<code>单向</code>的 。可以简单的理解，一个类A使用到了另一个类B，而这种使用关系是具有偶然性的、临时性的、非常弱的，但是B类的变化会影响到A类；</li>
</ul>
</li>
<li><p>代码提现：</p>
<ul>
<li>局部变量、方法中的参数和对静态方法的调用。</li>
</ul>
</li>
<li><p>关系图形：</p>
<ul>
<li>依赖关系用带普通箭头的虚线表示，由依赖的一方指向被依赖的一方。<img src="http://upload-images.jianshu.io/upload_images/590107-3869b6754bb52a87.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="依赖关系"></li>
</ul>
</li>
</ul>
<h3 id="组合、聚合、关联、依赖的总结与区别"><a href="#组合、聚合、关联、依赖的总结与区别" class="headerlink" title="组合、聚合、关联、依赖的总结与区别"></a>组合、聚合、关联、依赖的总结与区别</h3><ul>
<li><p>组合关系是关联关系的一种特例，这种关系比聚合更强，也称为强聚合；整体与部分是不可分的，整体的生命周期结束也就意味着部分的生命周期结束；例如：人与人的头和身体；</p>
</li>
<li><p>聚合关系也是关联关系的一种特例, 属于强的关联关系；整体与部分之间是可分离的，他们可以具有各自的生命周期。例如：电脑与CPU和键盘；</p>
</li>
<li><p>关联关系属于一种强依赖关系，不存在依赖关系的偶然性、关系也不是临时性的，一般是长期性的，而且双方的关系一般是平等的， 而聚合关系中双方的关系是不平等的，即：has-a。 </p>
</li>
<li><p>依赖关系是一种使用关系，单向；这种使用关系是具有偶然性的、临时性的、非常弱的。</p>
</li>
</ul>
<blockquote>
<p>SDWebImage的UML类图</p>
</blockquote>
<ul>
<li>github地址：<a target="_blank" rel="noopener" href="https://github.com/rs/SDWebImage">https://github.com/rs/SDWebImage</a></li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/590107-5a656e6c9f082724.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="SDWebImageClassDiagram.png"></p>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/posts/e07c4cd6/">iOS+Jenkins+git+蒲公英 (iOS自动打包）</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2017-06-21
        </span></div>
    </header>

    <div class="post-content"><p><img src="http://upload-images.jianshu.io/upload_images/590107-dc58ad8f1d6f8129.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<h2 id="1、Jenkins的安装与启动"><a href="#1、Jenkins的安装与启动" class="headerlink" title="1、Jenkins的安装与启动"></a>1、Jenkins的安装与启动</h2><ul>
<li><p>方式一：直接下载安装包<br><a target="_blank" rel="noopener" href="https://jenkins.io/index.html">https://jenkins.io/index.html</a><br>安装完成后在 Terminal 中输入，即可打开 Jenkins。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open &#x2F;Applications&#x2F;Jenkins&#x2F;jenkins.war</span><br></pre></td></tr></table></figure>
</li>
<li><p>方式二：使用homebrew</p>
<ol>
<li><p>安装 homebrew（如果已经安装，跳过此步）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ruby -e &quot;$(curl -fsSL https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;Homebrew&#x2F;install&#x2F;master&#x2F;install)&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>安装 Jenkins</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">brew install jenkins     </span><br><span class="line">&#96;&#96;&#96;  </span><br><span class="line"></span><br><span class="line">3.启动 Jenkins</span><br></pre></td></tr></table></figure>
<p>jenkins</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">## 2、访问Jenkins</span><br><span class="line">- 当Jenkins启动后，浏览器中输入  http:&#x2F;&#x2F;localhost:8080&#x2F;</span><br><span class="line"></span><br><span class="line">- 使用安装包安装会自动弹出了浏览器打开</span><br><span class="line"></span><br><span class="line">- 如果端口冲突那么请修改端口</span><br></pre></td></tr></table></figure>
<p>defaults write /Library/Preferences/org.jenkins-ci httpPort xxxx</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">![](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-2e947f45037f0381.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line"></span><br><span class="line">- 请前往图中红字所示地址</span><br><span class="line">![受保护-请修改文件访问权限](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-c40bddef94c4f86d.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line"></span><br><span class="line">- 修改文件访问权限后，进入该文件夹中，将&#96;initialAdminPassword&#96;中的密码拷贝到输入框，点击&#96;continue&#96;</span><br><span class="line"></span><br><span class="line">- 下载插件</span><br><span class="line">![选择左边-安装建议的插件](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-dcb0e7074609d615.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line"></span><br><span class="line">- 插件安装中。。。</span><br><span class="line">![插件安装中](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-cff5482499c94487.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line"></span><br><span class="line">- 插件安装完毕，创建账户-&gt;&#96;Save and Finish&#96;</span><br><span class="line">![创建管理员账户](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-cf6aea14195ed426.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line"></span><br><span class="line">- 账户创建成功</span><br><span class="line"></span><br><span class="line">## 3、Jenkins插件安装</span><br><span class="line">- 依次安装以下Jenkins插件</span><br></pre></td></tr></table></figure>
<p>GitLab<br>Xcode integration<br>Keychains and Provisioning Profiles Management</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 插件安装步骤</span><br><span class="line">![进入插件管理页面](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-434038a2912b1fa9.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line">![搜索并安装插件](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-c2f49af7c047b3ee.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line"></span><br><span class="line">## 4、创建Jenkins任务</span><br><span class="line">- 回到Jenkins首页，点击&#96;新建&#96;</span><br><span class="line">![创建Jenkins任务](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-efe92edfb9f37717.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line"></span><br><span class="line">## 5、配置刚刚创建好的Jenkins任务</span><br><span class="line">#### 5.1、设置源码管理（这里我们使用的是git）</span><br><span class="line">![配置Git远程仓库](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-91b8e142ec059222.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line"></span><br><span class="line">- 设置Gredentials</span><br><span class="line">![进入Gredentials页面](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-314317f40aa835a7.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line">![创建](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-3b68540b0ceaf7d6.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line">![配置](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-c1fafb236668c622.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line"></span><br><span class="line">- 如果不清楚上如中的&#96;Key&#96;, 应该填什么，请看下面</span><br><span class="line">1、前往文件夹</span><br></pre></td></tr></table></figure>
<p>~/.ssh/id_rsa</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">2、用文本编辑器打开&#96;id_rsa&#96;, 拷贝里面的内容到上图中&#96;Key&#96;的输入框，如下图</span><br><span class="line">  ![~&#x2F;.ssh&#x2F;id_rsa](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-535a453b70136339.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line"></span><br><span class="line">- 配置好Credential, 点击ok，再次回到项目的&#96;源码管理&#96;,选择Gredentials为我们刚刚创建的，如图</span><br><span class="line">![选择Gredentials](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-765a020e8d0863a7.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line"></span><br><span class="line">#### 5.2、设置构建触发器（可以触发构建操作的配置）</span><br><span class="line">![非必填，不配置的话需要手动点击构建](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-42d1da1fdc261a8a.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line"></span><br><span class="line">#### 5.3、设置构建环境，这里我们选择&#96;Keychains and Code Signing Identities&#96;</span><br><span class="line"></span><br><span class="line">- 勾选&#96;Keychains and Code Signing Identities&#96;</span><br><span class="line"></span><br><span class="line">- 配置&#96;Keychain&#96;和&#96; Provisioning Profiles&#96;</span><br><span class="line">    - 保存后进入&#96;Keychains and Provisioning Profiles Management&#96;页面，如果没有该选项，请参考上述&#96;第三步：Jenkins插件&#96;安装来安装&#96;Keychains and Provisioning Profiles Management&#96;插件</span><br><span class="line">![进入&#96;Keychains and Provisioning Profiles Management&#96;页面](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-a67676aed151ce9a.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line">   - </span><br><span class="line">![配置&#96;Keychain&#96;和&#96; Provisioning Profiles&#96;](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-458c88c5b7258a60.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line">![上图中的的&#96;Code Sining Identities&#96;来源(钥匙串中)](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-46823912e5866f36.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line"></span><br><span class="line">- 注意：保存后，在&#96;&#x2F;Users&#x2F;Shared&#x2F;Jenkins&#96;文件夹下如图：</span><br><span class="line">![需要出现&#96;Keychains&#96;和&#96;MobileDevice&#96;文件夹](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-32c0a3562d782b64.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line">如果未出现：</span><br><span class="line">1、直接将&#96;&#x2F;Users&#x2F;‘你的用户名’&#x2F;Library&#x2F;Keychains&#96;文件夹拷贝到&#96;&#x2F;Users&#x2F;Shared&#x2F;Jenkins&#96;文件夹下；</span><br><span class="line">2、直接将&#96;&#x2F;Users&#x2F;‘你的用户名’&#x2F;Library&#x2F;MobileDevice&#96;文件夹拷贝到&#96;&#x2F;Users&#x2F;Shared&#x2F;Jenkins&#96;文件夹下；</span><br><span class="line"></span><br><span class="line">- 注意：这里配置的证书是将来用来打包项目用的证书，必须与你将要打包的Xcode项目中的配置一致！！！</span><br><span class="line">- 注意：这里配置的证书是将来用来打包项目用的证书，必须与你将要打包的Xcode项目中的配置一致！！！</span><br><span class="line">- 注意：这里配置的证书是将来用来打包项目用的证书，必须与你将要打包的Xcode项目中的配置一致！！！</span><br><span class="line"></span><br><span class="line">- 需要手动配置Xcode项目的profile文件，不要使用&#96;Auto........&#96;,这里不再说明如何手动配置Xcode项目的profile文件</span><br><span class="line">至此，我们完成如下图的构建环境配置（如下图）</span><br><span class="line">![构建环境配置](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-1935ff0937c69a92.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### 5.4、设置构建操作（这里我们选择&#96;Xcode&#96;）</span><br><span class="line"></span><br><span class="line">- 点击增加构建步骤， 选择Xcode</span><br><span class="line">- 如果没有Xcode选项，请参考上述&#96;第三步：Jenkins插件&#96;安装来安装&#96;Xcode integration&#96;插件</span><br><span class="line">![增加构建步骤-Xcode](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-1d7cd44873448e41.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line"></span><br><span class="line">- 配置Xcode构建步骤</span><br><span class="line">  -  配置&#96;General build settings&#96;</span><br><span class="line">![General build settings](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-29ee273591301013.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line"></span><br><span class="line">  - 配置&#96;Code signing &amp; OS X keychain options&#96;</span><br><span class="line">![Code signing &amp; OS X keychain options](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-c63c0e36bfc45576.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line"></span><br><span class="line">  -  配置&#96;Advanced Xcode build options&#96;</span><br><span class="line">![Advanced Xcode build options](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-e594f8bee6a79572.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line"></span><br><span class="line">&gt; 此时我们所有的打包操作已经完毕，如果你仅仅是打包用，到此你可以点击保存，点击&#96;立即构建&#96;，进行构建操作了</span><br><span class="line"></span><br><span class="line">![立即构建](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-062b0ae9fb30fcc8.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line"></span><br><span class="line">既然已经做到这一步（自动打包），我们还可以配置一些构建操作，将打包后的IPA文件上传到蒲公英，便于测试！配置如下：</span><br><span class="line"></span><br><span class="line">- 1、在蒲公英网站上创建用户，获取到&#96;userKey&#96;和&#96;apiKey&#96;</span><br><span class="line">- 2、在Jenkins上再次配置下我们之前配置好的项目，在之前添加的&#96;Xcode&#96;构建步骤下，新增一个&#96;Execute shell&#96;构建步骤，如图：</span><br><span class="line">![Execute shell](http:&#x2F;&#x2F;upload-images.jianshu.io&#x2F;upload_images&#x2F;590107-232d94822576574b.png?imageMogr2&#x2F;auto-orient&#x2F;strip%7CimageView2&#x2F;2&#x2F;w&#x2F;1240)</span><br><span class="line">- 3、在&#96;command&#96;中填写如下命令：</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>#蒲公英上的User Key<br>uKey=”xxxxxxxxxxxxxxxxxxxxxxxx”</p>
</li>
</ol>
</li>
</ul>
<p>#蒲公英上的API Key<br>apiKey=”xxxxxxxxxxxxxxxxxxxxxxxx”</p>
<p>#要上传的ipa文件路径<br>IPA_PATH=”我们打包后的IPA文件地址”</p>
<p>#执行上传至蒲公英的命令，这句不需要修改<br>curl -F “file=@${IPA_PATH}” -F “uKey=${uKey}” -F “_api_key=${apiKey}” <a target="_blank" rel="noopener" href="https://www.pgyer.com/apiv1/app/upload">https://www.pgyer.com/apiv1/app/upload</a></p>
<p>```</p>
<ul>
<li>配置完毕，点击保存，我们再次构建我们的项目，如果不出意外，我们看到的是这样的标志<br><img src="http://upload-images.jianshu.io/upload_images/590107-47ad1b10c8040920.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="构建成功"><br>说明我们的项目构建成功，并成功发布到蒲公英，快去蒲公英上看看吧~~</li>
</ul>
<h2 id="6、常见报错及解决办法"><a href="#6、常见报错及解决办法" class="headerlink" title="6、常见报错及解决办法"></a>6、常见报错及解决办法</h2><p>1、This project contains no schemes<br><img src="http://upload-images.jianshu.io/upload_images/590107-f931c2e4070d605b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="This project contains no schemes"></p>
<ul>
<li><p>解决办法：<br><img src="http://upload-images.jianshu.io/upload_images/590107-f98d06a7ccc900d6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="勾选shared"></p>
</li>
<li><p>注意点：</p>
<ul>
<li>这里我们不能去Jenkins项目目录下修改Xcode项目的shared勾选，我们应该在本地的开发源码上修改，然后提交到git远程仓库，再次构建！！！</li>
<li>由于gitignor文件，我们有可能没有注意的情况下，并没有将shared勾选这个设置提交到远程仓库，导致再次侯建依旧失败！<br><img src="http://upload-images.jianshu.io/upload_images/590107-71fbbf44f2cb8aaa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></li>
</ul>
</li>
</ul>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/posts/da9fb1fe/">iOS中CoreAnimation的确认哪个动画结束(animationDidStop)</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2017-03-13
        </span></div>
    </header>

    <div class="post-content"><p>在CoreAnimation中我们可以通过CAAnimation对象的delegate方法 <code>- (void)animationDidStop:(CAAnimation *)anim finished:(BOOL)flag</code>来完成动画结束后的一些操作,但是有时候会出现点问题,比如多个CAAnimation对象的delegate为同一个对象,这样就要区分是哪一个CAAnimation对象,我们可以通过<code>[xxx.layer animationForKey:@&quot;key&quot;]</code>来获取到一个CAAnimation对象,然后与<code>- (void)animationDidStop:(CAAnimation *)anim finished:(BOOL)flag</code>方法中的<code>anim </code>来比较,但是有时候总是不对,这是就要添加如下代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yourAnimtion.removedOnCompletion &#x3D; NO;</span><br></pre></td></tr></table></figure>
<p>这样就可以通过<code>[xxx.layer animationForKey:@&quot;key&quot;];</code>查找到对应key的animation,接下来就可以接着添加你所需的该动画结束后的操作</p>
<ul>
<li>注意上面的方法是 <code>animationForKey :</code></li>
</ul>
<p>解决了上面的问题,不过一个循环引用的问题已可能悄悄发生了……</p>
<p>如果我们给这段动画设置了:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yourAnimtion.delegate &#x3D; self;  </span><br></pre></td></tr></table></figure>
<p>同时又让动画结束后不移除:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yourAnimtion.removedOnCompletion &#x3D; NO;</span><br></pre></td></tr></table></figure>

<p>于是……<br>self持有yourView –&gt; yourView持有yourView.layer –&gt; yourView.layer持有yourAnimtion，yourAnimtion又持有self   ==&gt;  <code>循环引用</code></p>
<p>那么为什么yourAnimtion会持有self 呢?</p>
<p>是因为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yourAnimtion.delegate &#x3D; self;  </span><br></pre></td></tr></table></figure>

<p>你肯定会想,delegate不会强引用self的,但是错了….请看下面的官方代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;* The delegate of the animation. This object is retained for the</span><br><span class="line"> * lifetime of the animation object. Defaults to nil. See below for the</span><br><span class="line"> * supported delegate methods. *&#x2F;</span><br><span class="line"></span><br><span class="line">@property(nullable, strong) id &lt;CAAnimationDelegate&gt; delegate;</span><br></pre></td></tr></table></figure>

<p>上面用的  <code>strong </code>   有木有……</p>
<p>解决循环引用的问题</p>
<p>在动画结束的delegate方法中:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[yourView.layer removeAllAnimations];</span><br></pre></td></tr></table></figure>

<p>或者:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[yourView.layer removeAnimationForKey:yourKey];</span><br></pre></td></tr></table></figure>






        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/posts/2b53fdc4/">nonnull、nullable、null_resettable、__null_unspecified</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2016-11-21
        </span></div>
    </header>

    <div class="post-content"><blockquote>
<p>nonnull : 不能为空</p>
</blockquote>
<ul>
<li>使用方法:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@property (nonatomic, copy, nonnull) NSString   *name1;</span><br><span class="line">@property (nonatomic, copy) NSString * _Nonnull  name2;</span><br><span class="line">@property (nonatomic, copy) NSString * __nonnull name3;</span><br></pre></td></tr></table></figure>
<img src="http://upload-images.jianshu.io/upload_images/590107-92c4b5de1d6b1c4a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="nonnull三种用法"></li>
</ul>
<blockquote>
<p>nullable : 可以为空</p>
</blockquote>
<ul>
<li>使用方法:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@property (nonatomic, copy, nullable)  NSString  *name1;</span><br><span class="line">@property (nonatomic, copy) NSString *_Nullable  name2;</span><br><span class="line">@property (nonatomic, copy) NSString *__nullable name3;</span><br></pre></td></tr></table></figure>
<img src="http://upload-images.jianshu.io/upload_images/590107-829f408488ec279e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="nullable三种方法"></li>
</ul>
<blockquote>
<p>null_resettable : get方法不能返回空, set方法可以为空</p>
</blockquote>
<ul>
<li>使用方法:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@property (nonatomic, strong, null_resettable) NSString *name;</span><br></pre></td></tr></table></figure>
<img src="http://upload-images.jianshu.io/upload_images/590107-9e558ca75d2e7a48.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="null_resettable使用方法.png"></li>
</ul>
<blockquote>
<p>_Null_unspecified : 不确定是否为空</p>
</blockquote>
<ul>
<li>使用方法:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@property (nonatomic, strong) NSString *_Null_unspecified  name1;</span><br><span class="line">@property (nonatomic, strong) NSString *__null_unspecified name2;</span><br></pre></td></tr></table></figure>
<img src="http://upload-images.jianshu.io/upload_images/590107-02f4b7ee43b3fece.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="_Null_unspecified2种方法.png"></li>
</ul>
<p>注意点:</p>
<blockquote>
<p>不能修饰一般数据类型</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/590107-599fa7f88114484f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="不能修饰一般数据类型"></p>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/posts/9d649d6a/">iOS 输入框(UITextField)密码明暗文切换</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2016-05-20
        </span></div>
    </header>

    <div class="post-content"><p>在做明暗文切换(密码输入框)的时候遇见一个坑,就是切换<code>secureTextEntry</code>的时候,输入框的光标会偏移,下面列出了一个解决办法及一种明暗文切换的方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">- (IBAction)pwdTextSwitch:(UIButton *)sender &#123;</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F; 前提:在xib中设置按钮的默认与选中状态的背景图 </span><br><span class="line">    &#x2F;&#x2F; 切换按钮的状态</span><br><span class="line">    sender.selected &#x3D; !sender.selected;</span><br><span class="line">    </span><br><span class="line">    if (sender.selected) &#123; &#x2F;&#x2F; 按下去了就是明文</span><br><span class="line">        </span><br><span class="line">        NSString *tempPwdStr &#x3D; self.pwdInput.text;</span><br><span class="line">        self.pwdInput.text &#x3D; @&quot;&quot;; &#x2F;&#x2F; 这句代码可以防止切换的时候光标偏移</span><br><span class="line">        self.pwdInput.secureTextEntry &#x3D; NO;</span><br><span class="line">        self.pwdInput.text &#x3D; tempPwdStr;</span><br><span class="line">        </span><br><span class="line">    &#125; else &#123; &#x2F;&#x2F; 暗文</span><br><span class="line">        </span><br><span class="line">        NSString *tempPwdStr &#x3D; self.pwdInput.text;</span><br><span class="line">        self.pwdInput.text &#x3D; @&quot;&quot;;</span><br><span class="line">        self.pwdInput.secureTextEntry &#x3D; YES;</span><br><span class="line">        self.pwdInput.text &#x3D; tempPwdStr;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/posts/8d6a4db4/">删除Xcode Source Control多余的Working Copies</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2016-05-04
        </span></div>
    </header>

    <div class="post-content"><p>由于公司最近开发新项目,在SVN上重新建了仓库,在一次提交代码的时候发现有点不对劲,莫名其妙的在Xcode <code>Source Control -&gt; Working Copies</code> 下有两个远程的仓库(一个是之前的老项目.一个是现在的新项目),见下图</p>
<p><img src="http://upload-images.jianshu.io/upload_images/590107-be6158dd2ee39871.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Working Copies"></p>
<p>这个其实并不影响开发,但是对于强迫症的人来说也格外不爽,比如:(为了方便观看,将文件目录收缩了)<br><img src="http://upload-images.jianshu.io/upload_images/590107-6bb1c110d0fb14bb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="提交代码"></p>
<p>每次提交为什么总是要提示老项目(表示已经被老项目折磨的体无完肤…)等等</p>
<blockquote>
<p>解决办法</p>
</blockquote>
<ul>
<li>1.进入新项目的所在的文件夹-&gt;找到<code>项目名称.xcodeproj</code>-&gt; 右击:显示包内容</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/590107-0e5d9a44e078f9f4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<ul>
<li>2.找到<code>project.xcworkspace</code>-&gt;右击:显示包内容</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/590107-d995fea464962886.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<ul>
<li>3.找到<code>xcshareddata</code> -&gt; <code>项目名称.xcscmblueprint</code>文件,并且用文本编辑器打开</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/590107-ab53a0430a05c603.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="文本编辑器打开:项目名称.xcscmblueprint"></p>
<ul>
<li>4.修改<code>项目名称.xcscmblueprint</code>文件<br>用文本编辑器打开后你会看到,大概是这个样子<br><img src="http://upload-images.jianshu.io/upload_images/590107-59d897ace6173d83.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="项目名称.xcscmblueprint"></li>
</ul>
<p>在<br><code>DVTSourceControlWorkspaceBlueprintWorkingCopyRepositoryLocationsKey </code><br><code>DVTSourceControlWorkspaceBlueprintWorkingCopyStatesKey </code><br><code>DVTSourceControlWorkspaceBlueprintWorkingCopyPathsKey </code><br><code>DVTSourceControlWorkspaceBlueprintRemoteRepositoriesKey </code><br>下面分别各有两个值,这就是问题的所在,我们只需删除我们不需要的并<code>保存</code>即可,见下图</p>
<p><img src="http://upload-images.jianshu.io/upload_images/590107-3ff455ea542968ea.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="删除不需要的并保存"></p>
<ul>
<li>5.重启Xcode</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/590107-2f9d4b451ffcf5c6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="重启Xcode后Working Copies"></p>

        </div></article>
      <article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/posts/ae72db13/">发现App占用磁盘空间瞬间变的很大很大.想必是这个问题</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2016-04-09
        </span></div>
    </header>

    <div class="post-content"><p>这些天在开发公司产品新版本、开发中突然注意到我们的App占用了我5个多G的磁盘空间,况且我还是经常重装调试，想必这肯定是哪里出现了问题,回家后用越狱机查看该App磁盘文件占用情况,发现了这5个G左右的磁盘占用基本都来此一个出处:沙盒中<code>temp</code>文件夹下的一个名为<code>stack-logs.xxxxx.index</code>的文件,查阅资料后发现这与Xcode设置有关,突然想起来,前几天调试BUG将<code>Scheme</code>中的<code>logging</code>选项下的<code>Malloc Stack</code>给打钩了,想必肯定是此处忘记取消打钩了.<br>于是乎做了如下验证,将<code>Mallo Stack</code>取消打钩,重装App,用pp助手检测该App占用磁盘空间,发现在<code>tmp</code>下并没有发现之前的那个文件<code>stack-logs.xxxxx.index</code>,磁盘占用量也处于稳定状态(1~2M),并没有出现暴涨的情况,看来真是这个东西在做鬼.<br>为了更加认定是这个<code>Malloc Stack</code>在做鬼,于是又将<code>Mallo Stack</code>打钩,问题又出现了,刚装App,用PP助手立即查看App磁盘占用,瞬间已经暴涨到了<code>80+M</code>,哎呀我的小心脏,查看文件结构后发现,又是<code>tmp</code>下的<code>stack-logs.xxxxx.index</code>在做鬼,上图留念一下:</p>
<p><img src="http://upload-images.jianshu.io/upload_images/590107-03e73a7087fd90f1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="App沙盒目录"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/590107-c2e5c564caecd32e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="沙盒tmp文件夹下"></p>
<p>随手滑动了几下,又切换了几个页面便是这样一种情况,吓人啊.</p>
<p><img src="http://upload-images.jianshu.io/upload_images/590107-ebbd1d11fef3bc07.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="随手滑动了几下之后"></p>
<p>此时此刻你还在什么,如果遇见类似问题立马查看你是不是也将<code>Malloc Stack</code>给打钩了(<code>Malloc Stack</code>设置如下图);</p>
<p><img src="http://upload-images.jianshu.io/upload_images/590107-abc4f4aa3e7dd1f2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Malloc Stack 设置页面"></p>
<p>最后,如果细心的同学在App运行的时候能在控制器看到类似的话语</p>
<p><img src="http://upload-images.jianshu.io/upload_images/590107-1c20c587763ce727.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="开启Malloc Stack后控制台提示"></p>

        </div></article>
      <nav class="pagination"><a class="prev" href="/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text">Prev</span>
      </a>
    <a class="next" href="/page/3/">
        <span class="next-text">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    </nav></section></div></div>
      </main>

      <footer id="footer" class="footer"><div class="social-links"></div><div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" target="_blank" rel="noopener" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">&copy;2015 - 2021<span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">YotrolZ</span>
  </span>
</div>
</footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div><script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/src/even.js?v=2.11.0"></script>
</body>
</html>
