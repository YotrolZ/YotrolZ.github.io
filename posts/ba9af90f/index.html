<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="theme-color" content="#f8f5ec"><meta name="msapplication-navbutton-color" content="#f8f5ec"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec"><meta name="description" content="YYCacheæºç å­¦ä¹ -åˆå§‹åŒ–åˆ†æ"><link rel="alternate" href="/atom.xml" title="YotrolZ" type="application/atom+xml"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.11.0"><link rel="canonical" href="http://yotrolz.com/posts/ba9af90f/"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/yotrolz/yotrolz.github.io@gh/lib/fancybox/jquery.fancybox.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/yotrolz/yotrolz.github.io@gh/css/style.css?v=2.11.0"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-138610487-3"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-138610487-3")</script><script id="baidu_push">!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script src="//cdn.jsdelivr.net/npm/leancloud-storage@4.10.0/dist/av-min.js"></script><script id="leancloud">AV.init({appId:"mqfPQEKBtui9puAJUkYFY7Jn-MdYXbMMI",appKey:"A6R0T4bEvcBsTU8pB7NhJ6Wl"})</script><script>window.config={leancloud:{show_visits:!1,app_id:"mqfPQEKBtui9puAJUkYFY7Jn-MdYXbMMI",app_key:"A6R0T4bEvcBsTU8pB7NhJ6Wl"},toc:!0,fancybox:!0,pjax:"",latex:!1}</script><title>YYCacheæºç å­¦ä¹ -åˆå§‹åŒ–åˆ†æ - YotrolZ</title><meta name="generator" content="Hexo 5.4.1"></head><body><div id="mobile-navbar" class="mobile-navbar"><div class="mobile-header-logo"> <a href="/." class="logo">YotrolZ</a></div><div class="mobile-navbar-icon"><span></span><span></span><span></span></div></div><nav id="mobile-menu" class="mobile-menu slideout-menu"><ul class="mobile-menu-list"><a href="/"><li class="mobile-menu-item">Home</li></a><a href="/archives/"><li class="mobile-menu-item">Archives</li></a><a href="/tags/"><li class="mobile-menu-item">Tags</li></a><a href="/categories/"><li class="mobile-menu-item">Categories</li></a></ul></nav><div class="container" id="mobile-panel"><header id="header" class="header"><div class="logo-wrapper"> <a href="/." class="logo">YotrolZ</a></div><nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item"> <a class="menu-item-link" href="/">Home</a></li><li class="menu-item"> <a class="menu-item-link" href="/archives/">Archives</a></li><li class="menu-item"> <a class="menu-item-link" href="/tags/">Tags</a></li><li class="menu-item"> <a class="menu-item-link" href="/categories/">Categories</a></li></ul></nav></header><main id="main" class="main"><div class="content-wrapper"><div id="content" class="content"><article class="post"><header class="post-header"><h1 class="post-title">YYCacheæºç å­¦ä¹ -åˆå§‹åŒ–åˆ†æ</h1><div class="post-meta"> <span class="post-time">2019-10-19</span> <span class="post-visits" style="display:none" data-url="/posts/ba9af90f/" data-title="YYCacheæºç å­¦ä¹ -åˆå§‹åŒ–åˆ†æ">Visits 0</span></div></header><div class="post-toc" id="post-toc"><h2 class="post-toc-title">Contents</h2><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#YYCache-%E7%AE%80%E4%BB%8B"><span class="toc-text">YYCache ç®€ä»‹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95"><span class="toc-text">æ–‡ä»¶ç›®å½•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3API"><span class="toc-text">ç›¸å…³API</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#YYCache-%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-text">YYCache åˆå§‹åŒ–</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#YYDiskCache-%E7%A3%81%E7%9B%98%E7%BC%93%E5%AD%98"><span class="toc-text">YYDiskCache ç£ç›˜ç¼“å­˜</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#YYDiskCache-%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-text">YYDiskCache åˆå§‹åŒ–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8E%E7%BC%93%E5%AD%98%E4%B8%AD%E8%8E%B7%E5%8F%96YYDiskCache%E5%AF%B9%E8%B1%A1"><span class="toc-text">ä»ç¼“å­˜ä¸­è·å–YYDiskCacheå¯¹è±¡</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#YYDiskCacheInitGlobal"><span class="toc-text">_YYDiskCacheInitGlobal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#YYDiskCacheGetGlobal"><span class="toc-text">_YYDiskCacheGetGlobal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#YYDiskCacheSetGlobal"><span class="toc-text">_YYDiskCacheSetGlobal</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9C%9F%E6%AD%A3%E7%9A%84%E5%88%9B%E5%BB%BAYYDiskCache%E5%AF%B9%E8%B1%A1"><span class="toc-text">çœŸæ­£çš„åˆ›å»ºYYDiskCacheå¯¹è±¡</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#YYMemoryCache-%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-text">YYMemoryCache åˆå§‹åŒ–</span></a></li></ol></div></div><div class="post-content"><h1 id="YYCache-ç®€ä»‹"><a href="#YYCache-ç®€ä»‹" class="headerlink" title="YYCache ç®€ä»‹"></a>YYCache ç®€ä»‹</h1><p>å…ˆæ¥çœ‹ä¸€ä¸‹å®˜æ–¹ä»‹ç»</p><ul><li><strong>LRU</strong>: ç¼“å­˜æ”¯æŒ LRU (least-recently-used) æ·˜æ±°ç®—æ³•ã€‚</li><li><strong>ç¼“å­˜æ§åˆ¶</strong>: æ”¯æŒå¤šç§ç¼“å­˜æ§åˆ¶æ–¹æ³•ï¼šæ€»æ•°é‡ã€æ€»å¤§å°ã€å­˜æ´»æ—¶é—´ã€ç©ºé—²ç©ºé—´ã€‚</li><li><strong>å…¼å®¹æ€§</strong>: API åŸºæœ¬å’Œ <code>NSCache</code> ä¿æŒä¸€è‡´, æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯<code>çº¿ç¨‹å®‰å…¨</code>çš„ã€‚</li><li><strong>å†…å­˜ç¼“å­˜</strong><ul><li><strong>å¯¹è±¡é‡Šæ”¾æ§åˆ¶</strong>: å¯¹è±¡çš„é‡Šæ”¾(release) å¯ä»¥é…ç½®ä¸ºåŒæ­¥æˆ–å¼‚æ­¥è¿›è¡Œï¼Œå¯ä»¥é…ç½®åœ¨ä¸»çº¿ç¨‹æˆ–åå°çº¿ç¨‹è¿›è¡Œã€‚</li><li><strong>è‡ªåŠ¨æ¸…ç©º</strong>: å½“æ”¶åˆ°å†…å­˜è­¦å‘Šæˆ– App è¿›å…¥åå°æ—¶ï¼Œç¼“å­˜å¯ä»¥é…ç½®ä¸ºè‡ªåŠ¨æ¸…ç©ºã€‚</li></ul></li><li><strong>ç£ç›˜ç¼“å­˜</strong><ul><li><strong>å¯å®šåˆ¶æ€§</strong>: ç£ç›˜ç¼“å­˜æ”¯æŒè‡ªå®šä¹‰çš„å½’æ¡£è§£æ¡£æ–¹æ³•ï¼Œä»¥æ”¯æŒé‚£äº›æ²¡æœ‰å®ç° NSCoding åè®®çš„å¯¹è±¡ã€‚</li><li><strong>å­˜å‚¨ç±»å‹æ§åˆ¶</strong>: ç£ç›˜ç¼“å­˜æ”¯æŒå¯¹æ¯ä¸ªå¯¹è±¡çš„å­˜å‚¨ç±»å‹ (SQLite/æ–‡ä»¶) è¿›è¡Œè‡ªåŠ¨æˆ–æ‰‹åŠ¨æ§åˆ¶ï¼Œä»¥è·å¾—æ›´é«˜çš„å­˜å–æ€§èƒ½ã€‚</li></ul></li></ul><span id="more"></span><h2 id="æ–‡ä»¶ç›®å½•"><a href="#æ–‡ä»¶ç›®å½•" class="headerlink" title="æ–‡ä»¶ç›®å½•"></a>æ–‡ä»¶ç›®å½•</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ YYCache</span><br><span class="line"> Â Â  â”œâ”€â”€ YYCache.h</span><br><span class="line"> Â Â  â”œâ”€â”€ YYCache.m</span><br><span class="line"> Â Â  â”œâ”€â”€ YYDiskCache.h</span><br><span class="line"> Â Â  â”œâ”€â”€ YYDiskCache.m</span><br><span class="line"> Â Â  â”œâ”€â”€ YYKVStorage.h</span><br><span class="line"> Â Â  â”œâ”€â”€ YYKVStorage.m</span><br><span class="line"> Â Â  â”œâ”€â”€ YYMemoryCache.h</span><br><span class="line"> Â Â  â””â”€â”€ YYMemoryCache.m</span><br></pre></td></tr></table></figure><h2 id="ç›¸å…³API"><a href="#ç›¸å…³API" class="headerlink" title="ç›¸å…³API"></a>ç›¸å…³API</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">YYCache</span> : <span class="title">NSObject</span></span></span><br><span class="line"><span class="comment">/// ä¸‰ä¸ªåªè¯»å±æ€§</span></span><br><span class="line"><span class="comment">//  â‘  Cacheåç§°</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">copy</span>, <span class="keyword">readonly</span>) <span class="built_in">NSString</span> *name;</span><br><span class="line"><span class="comment">//  â‘¡ å†…å­˜ç¼“å­˜</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">readonly</span>) YYMemoryCache *memoryCache;</span><br><span class="line"><span class="comment">//  â‘¢ ç£ç›˜ç¼“å­˜</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">readonly</span>) YYDiskCache *diskCache;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// åˆå§‹åŒ–ç›¸å…³æ–¹æ³•</span></span><br><span class="line">- (<span class="keyword">nullable</span> <span class="keyword">instancetype</span>)initWithName:(<span class="built_in">NSString</span> *)name;</span><br><span class="line">- (<span class="keyword">nullable</span> <span class="keyword">instancetype</span>)initWithPath:(<span class="built_in">NSString</span> *)path <span class="built_in">NS_DESIGNATED_INITIALIZER</span>;</span><br><span class="line">+ (<span class="keyword">nullable</span> <span class="keyword">instancetype</span>)cacheWithName:(<span class="built_in">NSString</span> *)name;</span><br><span class="line">+ (<span class="keyword">nullable</span> <span class="keyword">instancetype</span>)cacheWithPath:(<span class="built_in">NSString</span> *)path;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">instancetype</span>)init UNAVAILABLE_ATTRIBUTE;</span><br><span class="line">+ (<span class="keyword">instancetype</span>)new UNAVAILABLE_ATTRIBUTE;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> mark - Access Methods</span></span><br><span class="line"><span class="comment">/// æ˜¯å¦åŒ…å«æŸä¸ªç¼“å­˜å¯¹è±¡</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)containsObjectForKey:(<span class="built_in">NSString</span> *)key;</span><br><span class="line">- (<span class="keyword">void</span>)containsObjectForKey:(<span class="built_in">NSString</span> *)key withBlock:(<span class="keyword">nullable</span> <span class="keyword">void</span>(^)(<span class="built_in">NSString</span> *key, <span class="built_in">BOOL</span> contains))block;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// è·å–ç¼“å­˜å¯¹è±¡</span></span><br><span class="line">- (<span class="keyword">nullable</span> <span class="keyword">id</span>&lt;<span class="built_in">NSCoding</span>&gt;)objectForKey:(<span class="built_in">NSString</span> *)key;</span><br><span class="line">- (<span class="keyword">void</span>)objectForKey:(<span class="built_in">NSString</span> *)key withBlock:(<span class="keyword">nullable</span> <span class="keyword">void</span>(^)(<span class="built_in">NSString</span> *key, <span class="keyword">id</span>&lt;<span class="built_in">NSCoding</span>&gt; object))block;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// ä¿å­˜ç¼“å­˜å¯¹è±¡</span></span><br><span class="line">- (<span class="keyword">void</span>)setObject:(<span class="keyword">nullable</span> <span class="keyword">id</span>&lt;<span class="built_in">NSCoding</span>&gt;)object forKey:(<span class="built_in">NSString</span> *)key;</span><br><span class="line">- (<span class="keyword">void</span>)setObject:(<span class="keyword">nullable</span> <span class="keyword">id</span>&lt;<span class="built_in">NSCoding</span>&gt;)object forKey:(<span class="built_in">NSString</span> *)key withBlock:(<span class="keyword">nullable</span> <span class="keyword">void</span>(^)(<span class="keyword">void</span>))block;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// åˆ é™¤æŸä¸ªç¼“å­˜å¯¹è±¡</span></span><br><span class="line">- (<span class="keyword">void</span>)removeObjectForKey:(<span class="built_in">NSString</span> *)key;</span><br><span class="line">- (<span class="keyword">void</span>)removeObjectForKey:(<span class="built_in">NSString</span> *)key withBlock:(<span class="keyword">nullable</span> <span class="keyword">void</span>(^)(<span class="built_in">NSString</span> *key))block;</span><br><span class="line"></span><br><span class="line"><span class="comment">/// åˆ é™¤æ‰€æœ‰ç¼“å­˜å¯¹è±¡</span></span><br><span class="line">- (<span class="keyword">void</span>)removeAllObjects;</span><br><span class="line">- (<span class="keyword">void</span>)removeAllObjectsWithBlock:(<span class="keyword">void</span>(^)(<span class="keyword">void</span>))block;</span><br><span class="line">- (<span class="keyword">void</span>)removeAllObjectsWithProgressBlock:(<span class="keyword">nullable</span> <span class="keyword">void</span>(^)(<span class="keyword">int</span> removedCount, <span class="keyword">int</span> totalCount))progress</span><br><span class="line">                                 endBlock:(<span class="keyword">nullable</span> <span class="keyword">void</span>(^)(<span class="built_in">BOOL</span> error))end;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><ul><li><code>YYCache</code> ä¸­ <code>memoryCache</code> å’Œ <code>diskCache</code> å‡ä¸º <code>strong</code> ä¸” <code>readonly</code>ï¼›</li><li>ä¹Ÿå°±æ˜¯è¯´å½“æˆ‘ä»¬å¤–ç•Œä½¿ç”¨<code>YYCache</code>å¯¹è±¡çš„æ—¶å€™ï¼Œå¯¹å…¶å†…éƒ¨çš„ <code>memoryCache</code> å’Œ <code>diskCache</code> æˆå‘˜æ˜¯ <code>å¼ºå¼•ç”¨</code></li></ul><blockquote><p>çŸ¥è¯†ç‚¹: NS_DESIGNATED_INITIALIZER å’Œ NS_UNAVAILABLE</p></blockquote><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œä¸€ä¸ªç±»å¯èƒ½ä¼šæœ‰å¤šä¸ªå·¥å‚æ–¹æ³•æˆ–è€…åˆå§‹åŒ–æ–¹æ³•ï¼Œå½“å¤–ç•Œè°ƒç”¨æ—¶ï¼Œéš¾å…ä¼šå‚»å‚»åˆ†ä¸æ¸…æ¥šï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä½¿ç”¨è‹¹æœä¸ºå¼€å‘è€…æä¾›çš„ä¸¤ä¸ªå® <code>NS_DESIGNATED_INITIALIZER</code> å’Œ <code>NS_UNAVAILABLE</code> æ¥è¿›è¡Œæè¿°ï¼›</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> NS_DESIGNATED_INITIALIZER __attribute__((objc_designated_initializer))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> UNAVAILABLE_ATTRIBUTE __attribute__((unavailable))</span></span><br></pre></td></tr></table></figure><ul><li><strong>NS_DESIGNATED_INITIALIZER</strong></li></ul><p><a target="_blank" rel="noopener" href="https://developer.apple.com/library/archive/documentation/General/Conceptual/DevPedia-CocoaCore/MultipleInitializers.html">è‹¹æœå®˜æ–¹æ–‡æ¡£</a>ç»™å‡ºäº†ä¸€ä¸ªè°ƒç”¨é¡ºåºï¼Œè€Œæˆ‘ä»¬ä¹Ÿåº”è¯¥éµå®ˆè¿™ç§è°ƒç”¨é¡ºåºï¼Œä»¥ç¡®ä¿æ— è®ºå¤–éƒ¨è°ƒç”¨è€…ä»å“ªä¸ªå…¥å£è¿›å…¥ï¼Œéƒ½èƒ½å¤Ÿæ­£ç¡®çš„åˆå§‹åŒ–ï¼š<br><img src="https://developer.apple.com/library/archive/documentation/General/Conceptual/DevPedia-CocoaCore/Art/multiple_initializers_2x.png"></p><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼šæ— è®ºè°ƒç”¨å“ªç§åˆå§‹åŒ–æ–¹æ³•ï¼Œæœ€ç»ˆéƒ½ä¼šè°ƒç”¨ <code>designed initializer</code>, å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">instancetype</span>)initWithTitle:(<span class="built_in">NSString</span> *)title </span><br><span class="line">                         date:(<span class="built_in">NSDate</span> *)date <span class="built_in">NS_DESIGNATED_INITIALIZER</span>;</span><br></pre></td></tr></table></figure><ul><li><strong>NS_UNAVAILABLE</strong><br>ä½¿ç”¨ <code>NS_UNAVAILABLE</code> åä»£è¡¨<code>ç›´æ¥ç¦ç”¨</code>ï¼Œå¦‚æœä½¿ç”¨è¯¥æ–¹æ³•ï¼Œç¼–è¯‘å™¨å°±ä¼šæŠ¥é”™ï¼›</li></ul><h1 id="YYCache-åˆå§‹åŒ–"><a href="#YYCache-åˆå§‹åŒ–" class="headerlink" title="YYCache åˆå§‹åŒ–"></a>YYCache åˆå§‹åŒ–</h1><p>æˆ‘ä»¬ä»<code>NS_DESIGNATED_INITIALIZER</code>çš„åˆå§‹åŒ–æ–¹æ³•è¿›è¡Œåˆ†æ:</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">instancetype</span>)initWithPath:(<span class="built_in">NSString</span> *)path &#123;</span><br><span class="line">    <span class="keyword">if</span> (path.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// â‘  åˆå§‹åŒ–ç£ç›˜ç¼“å­˜</span></span><br><span class="line">    YYDiskCache *diskCache = [[YYDiskCache alloc] initWithPath:path];</span><br><span class="line">    <span class="keyword">if</span> (!diskCache) <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">    <span class="built_in">NSString</span> *name = [path lastPathComponent];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// â‘¡ åˆå§‹åŒ–å†…å­˜ç¼“å­˜</span></span><br><span class="line">    YYMemoryCache *memoryCache = [YYMemoryCache new];</span><br><span class="line">    memoryCache.name = name;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// â‘¢ åˆå§‹åŒ–æœ¬èº«å¹¶å¯¹å†…éƒ¨çš„ä¸‰ä¸ªåªè¯»å±æ€§è¿›è¡Œèµ‹å€¼</span></span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">    _name = name;</span><br><span class="line">    _diskCache = diskCache;</span><br><span class="line">    _memoryCache = memoryCache;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“ç„¶äº†ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥ä½¿ç”¨<code>- (instancetype)initWithName:(NSString *)name</code>è¿›è¡Œåˆå§‹åŒ–ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ï¼Œé»˜è®¤å­˜å‚¨çš„<code>path</code></p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">instancetype</span>)initWithName:(<span class="built_in">NSString</span> *)name &#123;</span><br><span class="line">    <span class="keyword">if</span> (name.length == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">    <span class="built_in">NSString</span> *cacheFolder = [<span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSCachesDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>) firstObject];</span><br><span class="line">    <span class="built_in">NSString</span> *path = [cacheFolder stringByAppendingPathComponent:name];</span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">self</span> initWithPath:path];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="YYDiskCache-ç£ç›˜ç¼“å­˜"><a href="#YYDiskCache-ç£ç›˜ç¼“å­˜" class="headerlink" title="YYDiskCache ç£ç›˜ç¼“å­˜"></a>YYDiskCache ç£ç›˜ç¼“å­˜</h1><h2 id="YYDiskCache-åˆå§‹åŒ–"><a href="#YYDiskCache-åˆå§‹åŒ–" class="headerlink" title="YYDiskCache  åˆå§‹åŒ–"></a>YYDiskCache åˆå§‹åŒ–</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">YYDiskCache</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Cache name</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nullable</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *name;</span><br><span class="line"><span class="comment">// Cache path</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>) <span class="built_in">NSString</span> *path;</span><br><span class="line"><span class="comment">// ç£ç›˜ç¼“å­˜æ–¹å¼çš„ä¸€ä¸ªé˜ˆå€¼ï¼Œé»˜è®¤æ˜¯20KB</span></span><br><span class="line"><span class="comment">// ğŸ””â—ï¸â—ï¸â—ï¸å¦‚æœè¦å­˜å‚¨çš„æ•°æ®å¤§å°(ä»¥å­—èŠ‚ä¸ºå•ä½)å¤§äºè¯¥é˜ˆå€¼ï¼Œåˆ™å°†å…¶å­˜å‚¨ä¸ºæ–‡ä»¶ï¼Œå¦åˆ™å°†å…¶å­˜å‚¨åœ¨sqliteä¸­</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">readonly</span>) <span class="built_in">NSUInteger</span> inlineThreshold;</span><br><span class="line"></span><br><span class="line">Â·Â·Â·Â·Â·Â·</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆå§‹åŒ– (NS_DESIGNATED_INITIALIZER)</span></span><br><span class="line">- (<span class="keyword">nullable</span> <span class="keyword">instancetype</span>)initWithPath:(<span class="built_in">NSString</span> *)path</span><br><span class="line">                      inlineThreshold:(<span class="built_in">NSUInteger</span>)threshold <span class="built_in">NS_DESIGNATED_INITIALIZER</span>;</span><br><span class="line"></span><br><span class="line">Â·Â·Â·Â·Â·Â·</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><p>åˆå§‹åŒ–<code>YYCache</code>æ—¶è°ƒç”¨äº† <code>YYDiskCache</code> çš„ <code>initWithPath</code> æ–¹æ³•</p><ul><li><p>è¿™é‡Œä¸»è¦æ˜¯å¯¹ inlineThreshold é˜ˆå€¼è¿›è¡Œäº†åˆå§‹åŒ–(20KB)</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">instancetype</span>)initWithPath:(<span class="built_in">NSString</span> *)path &#123;</span><br><span class="line">  <span class="keyword">return</span> [<span class="keyword">self</span> initWithPath:path inlineThreshold:<span class="number">1024</span> * <span class="number">20</span>]; <span class="comment">// 20KB</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>çœŸæ­£çš„åˆå§‹åŒ–æ–¹æ³•(NS_DESIGNATED_INITIALIZER)</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">instancetype</span>)initWithPath:(<span class="built_in">NSString</span> *)path</span><br><span class="line">            inlineThreshold:(<span class="built_in">NSUInteger</span>)threshold &#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">self</span>) <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// â‘  æ ¹æ®pathåˆ©ç”¨_YYDiskCacheGetGlobalè·å–YYDiskCacheå¯¹è±¡</span></span><br><span class="line">    YYDiskCache *globalCache = _YYDiskCacheGetGlobal(path);</span><br><span class="line">    <span class="comment">// å­˜åœ¨çš„è¯ç›´æ¥è¿”å›ï¼Œä¸éœ€åˆ›å»º</span></span><br><span class="line">    <span class="keyword">if</span> (globalCache) <span class="keyword">return</span> globalCache;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// â‘¡ çœŸæ­£çš„åˆå§‹åŒ–æ“ä½œ</span></span><br><span class="line">    Â·Â·Â·Â·Â·Â· <span class="comment">// ä¸‹æ–‡åˆ†æ</span></span><br><span class="line">    </span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(_appWillBeTerminated) name:<span class="built_in">UIApplicationWillTerminateNotification</span> object:<span class="literal">nil</span>];</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><h2 id="ä»ç¼“å­˜ä¸­è·å–YYDiskCacheå¯¹è±¡"><a href="#ä»ç¼“å­˜ä¸­è·å–YYDiskCacheå¯¹è±¡" class="headerlink" title="ä»ç¼“å­˜ä¸­è·å–YYDiskCacheå¯¹è±¡"></a>ä»ç¼“å­˜ä¸­è·å–YYDiskCacheå¯¹è±¡</h2><p>åœ¨ä¸Šæ–‡ä¸­æˆ‘ä»¬å¾—çŸ¥ï¼Œ<code>YYDiskCache</code>åœ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šæ ¹æ®<code>path</code> è°ƒç”¨ <code>_YYDiskCacheGetGlobal</code>æ¥è¿›è¡ŒæŸ¥æ‰¾ï¼Œå¦‚æœæŸ¥åˆ°ï¼Œå°±ç›´æ¥è¿”å›ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å°±æ‰§è¡Œä¸€ç³»åˆ—çš„åˆå§‹åŒ–æ“ä½œï¼Œç„¶ååˆè°ƒç”¨ <code>_YYDiskCacheSetGlobal</code> å°†åˆ›å»ºå¥½çš„<code>YYDiskCache</code> å¯¹è±¡å­˜å…¥ï¼Œç°åœ¨æˆ‘ä»¬æ¥åˆ†æä¸€ä¸‹ <code>_YYDiskCacheGetGlobal</code> å’Œ <code>_YYDiskCacheSetGlobal</code>ï¼›</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// weak reference for all instances</span></span><br><span class="line"><span class="type">static</span> NSMapTable *_globalInstances;</span><br><span class="line"><span class="type">static</span> <span class="type">dispatch_semaphore_t</span> _globalInstancesLock;</span><br></pre></td></tr></table></figure><ul><li>å®šä¹‰äº†ä¸€ä¸ªå…¨å±€çš„ <code>NSMapTable</code> ç±»å‹çš„ <code>_globalInstances</code> å’Œ ä¸€ä¸ª <code>dispatch_semaphore_t</code> ç±»å‹çš„ <code>_globalInstancesLock</code>;</li><li><code>_globalInstances</code>ï¼šå­˜æ”¾æ‰€æœ‰çš„ <code>YYDiskCache</code> å¯¹è±¡</li><li><code>dispatch_semaphore_t</code>ï¼šç”¨æ¥ä¿è¯<code>çº¿ç¨‹å®‰å…¨</code></li></ul><h3 id="YYDiskCacheInitGlobal"><a href="#YYDiskCacheInitGlobal" class="headerlink" title="_YYDiskCacheInitGlobal"></a>_YYDiskCacheInitGlobal</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">void</span> _YYDiskCacheInitGlobal() &#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">dispatch_once_t</span> onceToken;</span><br><span class="line">    <span class="built_in">dispatch_once</span>(&amp;onceToken, ^&#123;</span><br><span class="line">        _globalInstancesLock = <span class="built_in">dispatch_semaphore_create</span>(<span class="number">1</span>);</span><br><span class="line">        _globalInstances = [[NSMapTable alloc] initWithKeyOptions:NSPointerFunctionsStrongMemory valueOptions:NSPointerFunctionsWeakMemory capacity:<span class="number">0</span>];</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨<code>dispatch_once</code>ä¿è¯åªåˆå§‹åŒ–ä¸€æ¬¡ï¼›</li><li>ğŸ””â—ï¸â—ï¸â—ï¸ <code>_globalInstances</code> ç”¨æ¥å­˜æ”¾æ‰€æœ‰çš„ <code>YYDiskCache</code>å¯¹è±¡ï¼Œ ä½¿ç”¨ <code>NSMapTable</code> + <code>NSPointerFunctionsWeakMemory</code>ï¼Œ <code>å¼±å¼•ç”¨</code> å†…éƒ¨çš„ <code>YYDiskCache</code>å¯¹è±¡ï¼›</li></ul><h3 id="YYDiskCacheGetGlobal"><a href="#YYDiskCacheGetGlobal" class="headerlink" title="_YYDiskCacheGetGlobal"></a>_YYDiskCacheGetGlobal</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> YYDiskCache *_YYDiskCacheGetGlobal(NSString *path) &#123;</span><br><span class="line">    <span class="keyword">if</span> (path.length == <span class="number">0</span>) <span class="keyword">return</span> nil;</span><br><span class="line">    _YYDiskCacheInitGlobal();</span><br><span class="line">    <span class="built_in">dispatch_semaphore_wait</span>(_globalInstancesLock, DISPATCH_TIME_FOREVER);</span><br><span class="line">    id cache = [_globalInstances objectForKey:path];</span><br><span class="line">    <span class="built_in">dispatch_semaphore_signal</span>(_globalInstancesLock);</span><br><span class="line">    <span class="keyword">return</span> cache;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨è°ƒç”¨<code>_YYDiskCacheGetGlobal</code>æ—¶ä¼šè°ƒç”¨<code>_YYDiskCacheInitGlobal</code> è¿›è¡Œåˆå§‹åŒ–ï¼›</li><li>ç”±äº<code>_YYDiskCacheInitGlobal</code>å†…éƒ¨ä½¿ç”¨<code>dispatch_once</code>ï¼Œå¯ä¿è¯åªåˆå§‹åŒ–äº†ä¸€æ¬¡ï¼›</li></ul><h3 id="YYDiskCacheSetGlobal"><a href="#YYDiskCacheSetGlobal" class="headerlink" title="_YYDiskCacheSetGlobal"></a>_YYDiskCacheSetGlobal</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">void</span> _YYDiskCacheSetGlobal(YYDiskCache *cache) &#123;</span><br><span class="line">    <span class="keyword">if</span> (cache.path.length == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">    _YYDiskCacheInitGlobal();</span><br><span class="line">    <span class="built_in">dispatch_semaphore_wait</span>(_globalInstancesLock, DISPATCH_TIME_FOREVER);</span><br><span class="line">    [_globalInstances setObject:cache forKey:cache.path];</span><br><span class="line">    <span class="built_in">dispatch_semaphore_signal</span>(_globalInstancesLock);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨è°ƒç”¨<code>_YYDiskCacheGetGlobal</code>æ—¶ä¼šè°ƒç”¨<code>_YYDiskCacheInitGlobal</code> è¿›è¡Œåˆå§‹åŒ–ï¼›</li><li>ç”±äº<code>_YYDiskCacheInitGlobal</code>å†…éƒ¨ä½¿ç”¨<code>dispatch_once</code>ï¼Œå¯ä¿è¯åªåˆå§‹åŒ–äº†ä¸€æ¬¡ï¼›</li></ul><h2 id="çœŸæ­£çš„åˆ›å»ºYYDiskCacheå¯¹è±¡"><a href="#çœŸæ­£çš„åˆ›å»ºYYDiskCacheå¯¹è±¡" class="headerlink" title="çœŸæ­£çš„åˆ›å»ºYYDiskCacheå¯¹è±¡"></a>çœŸæ­£çš„åˆ›å»ºYYDiskCacheå¯¹è±¡</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">instancetype</span>)initWithPath:(<span class="built_in">NSString</span> *)path</span><br><span class="line">            inlineThreshold:(<span class="built_in">NSUInteger</span>)threshold &#123;</span><br><span class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">    <span class="keyword">if</span> (!<span class="keyword">self</span>) <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// â‘  æ ¹æ®pathåˆ©ç”¨_YYDiskCacheGetGlobalè·å–YYDiskCacheå¯¹è±¡</span></span><br><span class="line">    YYDiskCache *globalCache = _YYDiskCacheGetGlobal(path);</span><br><span class="line">    <span class="comment">// å­˜åœ¨çš„è¯ç›´æ¥è¿”å›ï¼Œä¸éœ€åˆ›å»º</span></span><br><span class="line">    <span class="keyword">if</span> (globalCache) <span class="keyword">return</span> globalCache;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// â‘¡ YYDiskCache çœŸæ­£çš„åˆå§‹åŒ–æ“ä½œ</span></span><br><span class="line">    YYKVStorageType type;</span><br><span class="line">    <span class="keyword">if</span> (threshold == <span class="number">0</span>) &#123;</span><br><span class="line">        type = YYKVStorageTypeFile;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (threshold == <span class="built_in">NSUIntegerMax</span>) &#123;</span><br><span class="line">        type = YYKVStorageTypeSQLite;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        type = YYKVStorageTypeMixed;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// çœŸæ­£å®ç°æ•°æ®å­˜å–çš„å¯¹è±¡</span></span><br><span class="line">    YYKVStorage *kv = [[YYKVStorage alloc] initWithPath:path type:type];</span><br><span class="line">    <span class="keyword">if</span> (!kv) <span class="keyword">return</span> <span class="literal">nil</span>;</span><br><span class="line">    </span><br><span class="line">    _kv = kv;</span><br><span class="line">    _path = path;</span><br><span class="line">    <span class="comment">// ä½¿ç”¨GCD ä¿¡å·é‡ åˆ›å»ºäº†ä¸€æŠŠé”ï¼Œä¿è¯çº¿ç¨‹å®‰å…¨</span></span><br><span class="line">    _lock = dispatch_semaphore_create(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">// åˆ›å»ºäº†ä¸€ä¸ªè‡ªå®šä¹‰çš„å¹¶å‘é˜Ÿåˆ—</span></span><br><span class="line">    _queue = dispatch_queue_create(<span class="string">&quot;com.ibireme.cache.disk&quot;</span>, DISPATCH_QUEUE_CONCURRENT);</span><br><span class="line">    _inlineThreshold = threshold;</span><br><span class="line">    _countLimit = <span class="built_in">NSUIntegerMax</span>;</span><br><span class="line">    _costLimit = <span class="built_in">NSUIntegerMax</span>;</span><br><span class="line">    _ageLimit = DBL_MAX;</span><br><span class="line">    _freeDiskSpaceLimit = <span class="number">0</span>;</span><br><span class="line">    _autoTrimInterval = <span class="number">60</span>;</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span> _trimRecursively];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// â‘¢ å­˜å…¥ï¼š_YYDiskCacheSetGlobal</span></span><br><span class="line">    _YYDiskCacheSetGlobal(<span class="keyword">self</span>);</span><br><span class="line">    </span><br><span class="line">    [[<span class="built_in">NSNotificationCenter</span> defaultCenter] addObserver:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(_appWillBeTerminated) name:<span class="built_in">UIApplicationWillTerminateNotification</span> object:<span class="literal">nil</span>];</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="YYMemoryCache-åˆå§‹åŒ–"><a href="#YYMemoryCache-åˆå§‹åŒ–" class="headerlink" title="YYMemoryCache åˆå§‹åŒ–"></a>YYMemoryCache åˆå§‹åŒ–</h1></div><div class="post-copyright"><p class="copyright-item"> <span>Author:</span> <a href="http://yotrolz.com">YotrolZ</a></p><p class="copyright-item"> <span>Link:</span> <a href="http://yotrolz.com/posts/ba9af90f/">http://yotrolz.com/posts/ba9af90f/</a></p><p class="copyright-item"> <span>License:</span> <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨ 4.0 å›½é™…è®¸å¯åè®®</a></p></div><footer class="post-footer"><nav class="post-nav"><a class="prev" href="/posts/5c5f8fb2/"><i class="iconfont icon-left"></i> <span class="prev-text nav-default">YYCacheæºç å­¦ä¹ -ç£ç›˜ç¼“å­˜åˆ†æ</span> <span class="prev-text nav-mobile">Prev</span></a> <a class="next" href="/posts/d115d42e/"><span class="next-text nav-default">å›¾è§£iOS Blockåº•å±‚åŸç†</span> <span class="prev-text nav-mobile">Next</span><i class="iconfont icon-right"></i></a></nav></footer></article></div><div class="comments" id="comments"></div></div></main><footer id="footer" class="footer"><div class="social-links"></div><div class="copyright"> <span class="power-by">Powered by <a class="hexo-link" target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a></span> <span class="division">|</span> <span class="theme-info">Theme - <a class="theme-link" target="_blank" rel="noopener" href="https://github.com/ahonn/hexo-theme-even">Even</a></span> <span class="copyright-year">&copy;2015 - 2022<span class="heart"><i class="iconfont icon-heart"></i></span> <span class="author">YotrolZ</span></span></div></footer><div class="back-to-top" id="back-to-top"><i class="iconfont icon-up"></i></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/yotrolz/yotrolz.github.io@gh/lib/jquery/jquery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/yotrolz/yotrolz.github.io@gh/lib/slideout/slideout.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/yotrolz/yotrolz.github.io@gh/lib/fancybox/jquery.fancybox.pack.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/yotrolz/yotrolz.github.io@gh/js/src/even.js?v=2.11.0"></script></body></html>