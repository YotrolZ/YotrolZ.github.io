<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="theme-color" content="#f8f5ec"><meta name="msapplication-navbutton-color" content="#f8f5ec"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec"><meta name="description" content="设计模式03--抽象工厂模式(iOS)"><link rel="alternate" href="/atom.xml" title="YotrolZ" type="application/atom+xml"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.11.0"><link rel="canonical" href="http://yotrolz.com/posts/aea66cc7/"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/yotrolz/yotrolz.github.io@gh/lib/fancybox/jquery.fancybox.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/yotrolz/yotrolz.github.io@gh/css/style.css?v=2.11.0"><script async src="https://www.googletagmanager.com/gtag/js?id=UA-138610487-3"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-138610487-3")</script><script id="baidu_push">!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script src="//cdn.jsdelivr.net/npm/leancloud-storage@4.10.0/dist/av-min.js"></script><script id="leancloud">AV.init({appId:"mqfPQEKBtui9puAJUkYFY7Jn-MdYXbMMI",appKey:"A6R0T4bEvcBsTU8pB7NhJ6Wl"})</script><script>window.config={leancloud:{show_visits:!1,app_id:"mqfPQEKBtui9puAJUkYFY7Jn-MdYXbMMI",app_key:"A6R0T4bEvcBsTU8pB7NhJ6Wl"},toc:!0,fancybox:!0,pjax:"",latex:!1}</script><title>设计模式03--抽象工厂模式(iOS) - YotrolZ</title><meta name="generator" content="Hexo 5.4.1"></head><body><div id="mobile-navbar" class="mobile-navbar"><div class="mobile-header-logo"> <a href="/." class="logo">YotrolZ</a></div><div class="mobile-navbar-icon"><span></span><span></span><span></span></div></div><nav id="mobile-menu" class="mobile-menu slideout-menu"><ul class="mobile-menu-list"><a href="/"><li class="mobile-menu-item">Home</li></a><a href="/archives/"><li class="mobile-menu-item">Archives</li></a><a href="/tags/"><li class="mobile-menu-item">Tags</li></a><a href="/categories/"><li class="mobile-menu-item">Categories</li></a></ul></nav><div class="container" id="mobile-panel"><header id="header" class="header"><div class="logo-wrapper"> <a href="/." class="logo">YotrolZ</a></div><nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item"> <a class="menu-item-link" href="/">Home</a></li><li class="menu-item"> <a class="menu-item-link" href="/archives/">Archives</a></li><li class="menu-item"> <a class="menu-item-link" href="/tags/">Tags</a></li><li class="menu-item"> <a class="menu-item-link" href="/categories/">Categories</a></li></ul></nav></header><main id="main" class="main"><div class="content-wrapper"><div id="content" class="content"><article class="post"><header class="post-header"><h1 class="post-title">设计模式03--抽象工厂模式(iOS)</h1><div class="post-meta"> <span class="post-time">2017-12-25</span> <span class="post-visits" style="display:none" data-url="/posts/aea66cc7/" data-title="设计模式03--抽象工厂模式(iOS)">Visits 0</span></div></header><div class="post-content"><blockquote><p><strong>0、序</strong></p></blockquote><ul><li>在上一篇文章<a target="_blank" rel="noopener" href="http://www.jianshu.com/p/ec97eb083fe1">《工厂方法模式》</a>中，我们定义了奥迪工厂<code>AudiFactory</code> 生产出来的就是<code>奥迪汽车</code>和 奔驰工厂<code>BenzFactory</code>生产出来的就是<code>奔驰汽车</code>，但是随着其发展，奥迪工厂不仅仅生产一种车了，而是生产种种系列车型，比如有SUV系列产品与MPV系列产品，那么此时我们的<code>AudiFactory</code> 就不能满足需求了，那么该怎么办呢？</li><li><code>抽象工厂模式</code>正好能解决上面的问题，让我们一起来看看抽象工厂。</li><li>在之前我们先记住上面的一个词<code>系列产品</code>；</li></ul><span id="more"></span><blockquote><p><strong>1、抽象工厂模式简述</strong></p></blockquote><ul><li><p>对一组具有<code>相同主题</code>的工厂进行封装</p><ul><li><p>以上面的汽车为例，在抽象工厂模式中，会有SUV工厂和MPV工厂，还有一个大的抽象工厂，里面涵盖了SUV工厂和MPV工厂所有能做的事情。</p></li><li><p>上面所说的SUV工厂、MPV工厂其实都是可以生产一系列产品的(SUV汽车或者MPV汽车)，也就是<code>产品族</code>的概念。而在工厂方法模式中，其工厂生产出来的产品是属于同一个<code>产品等级</code>(比如：不同厂商生产的汽车-奥迪汽车和奔驰汽车)。</p></li><li><p><img src="http://upload-images.jianshu.io/upload_images/590107-302923e38efaae11.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="相图"></p></li></ul></li></ul><blockquote><p><strong>2、抽象工厂模式角色划分</strong></p></blockquote><ul><li><p><strong>抽象工厂</strong></p><ul><li>抽象类，内部提供了所有工厂的接口</li></ul></li><li><p><strong>具体工厂</strong></p><ul><li>具体工厂：可生产所有的系列产品(<code>产品族</code>)；</li></ul></li><li><p><strong>产品系列A</strong></p><ul><li>抽象产品A：内部提供了A系列产品的共有功能；</li><li>具体产品A：A系列具体的单个产品;</li><li><em>注：当然，还有A系列的其他的产品，它们属于同一个<code>产品等级</code></em>;</li></ul></li><li><p><strong>产品系列B</strong></p><ul><li>抽象产品B：内部提供了B系列产品的共有功能；</li><li>具体产品B：B系列具体的单个产品；</li><li><em><strong>注</strong>：当然，还有B系列的其他的产品，它们属于同一个<code>产品等级</code></em>;</li></ul></li></ul><blockquote><p><strong>3、抽象工厂模式UML类图</strong></p></blockquote><ul><li><img src="http://upload-images.jianshu.io/upload_images/590107-304930132fb19d52.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="抽象工厂模式"></li></ul><blockquote><p><strong>4、抽象工厂模式示意代码</strong></p></blockquote><ul><li><p><strong>抽象工厂: <code>YCarAbsFactory</code></strong></p><ul><li>内部提供了所有工厂的接口<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@protocol YCarAbsFactory &lt;NSObject&gt;</span><br><span class="line">+ (id&lt;YSuvCar&gt;)creatSuvCar; // 创建SUV系列的车</span><br><span class="line">+ (id&lt;YMpvCar&gt;)creatMpvCar; // 创建MPV系列的车</span><br><span class="line">@end</span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>具体工厂</strong></p><ul><li>具体工厂1：<code>YAudiCarFactory</code>：可生产所有的系列产品(<code>产品族</code>)；<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@implementation YAudiCarFactory</span><br><span class="line">+ (id&lt;YSuvCar&gt;)creatSuvCar &#123; </span><br><span class="line">    return [[YAudiSuvCar alloc] init]; // 创建具体的奥迪SUV</span><br><span class="line">&#125;</span><br><span class="line">+ (id&lt;YMpvCar&gt;)creatMpvCar &#123;</span><br><span class="line">    return [[YAudiMpvCar alloc] init]; // 创建具体的奥迪MPV</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure></li><li>具体工厂2：<code>YBenzCarFactory</code>：可生产所有的系列产品(<code>产品族</code>)；</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@implementation YBenzCarFactory</span><br><span class="line">+ (id&lt;YSuvCar&gt;)creatSuvCar &#123;</span><br><span class="line">    return [[YBenzSuvCar alloc] init];  // 创建具体的奔驰SUV</span><br><span class="line">&#125;</span><br><span class="line">+ (id&lt;YMpvCar&gt;)creatMpvCar &#123;</span><br><span class="line">    return [[YBenzMpvCar alloc] init]; // 创建具体的奔驰MPV</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure><ul><li><em><strong>补充：</strong>可能还会有一个具体工厂3，比如：宝马工厂</em>，宝马工厂同样能生产SUV的车和MPV的车，并且根据需要在内部实现创建具体的产品逻辑；</li></ul></li><li><p><strong>产品系列A</strong></p><ul><li>抽象产品：<code>YSuvCar</code>：内部提供了A系列产品的共有功能；<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@protocol YSuvCar &lt;NSObject&gt;</span><br><span class="line">- (void)suvRun;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure></li><li>具体产品a1：<code>YAudiSuvCar</code><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@implementation YAudiSuvCar</span><br><span class="line">- (void)suvRun &#123;</span><br><span class="line">    NSLog(@&quot;奥迪SUV跑起来了&quot;);</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure></li><li>具体产品a2：<code>YBenzSuvCar</code><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@implementation YBenzSuvCar</span><br><span class="line">- (void)suvRun &#123;</span><br><span class="line">    NSLog(@&quot;奔驰SUV跑起来了&quot;);</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure></li><li><strong>注</strong>：上面的a1、a2属于同一个**<code>产品族</code><strong>(SUV车系)的不同</strong><code>产品等级</code>**(奥迪、奔驰)；</li></ul></li></ul><ul><li><p><strong>产品系列B</strong></p><ul><li><p>抽象产品B：<code>YMpvCar</code>：内部提供了B系列产品的共有功能；</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@protocol YMpvCar &lt;NSObject&gt;</span><br><span class="line">- (void)mpvRun;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure></li><li><p>具体产品b1：<code>YAudiMpvCar</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@implementation YAudiMpvCar</span><br><span class="line">- (void)mpvRun &#123;</span><br><span class="line">    NSLog(@&quot;奥迪MPV跑起来了&quot;);</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure></li><li><p>具体产品b2：<code>YBenzMpvCar</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@implementation YBenzMpvCar</span><br><span class="line">- (void)mpvRun &#123;</span><br><span class="line">    NSLog(@&quot;奔驰MPV跑起来了&quot;);</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure></li><li><p><strong>注</strong>：上面的b1、b2属于同一个**<code>产品族</code><strong>(MPV车系)的不同</strong><code>产品等级</code>**(奥迪、奔驰)；</p></li></ul></li><li><p><strong>Client使用</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// 奥迪SUV</span><br><span class="line">id&lt;YSuvCar&gt; audiSuv = [YAudiCarFactory creatSuvCar];</span><br><span class="line">[audiSuv suvRun];</span><br><span class="line">// 奥迪MPV</span><br><span class="line">id&lt;YMpvCar&gt; audiMpv = [YAudiCarFactory creatMpvCar];</span><br><span class="line">[audiMpv mpvRun];</span><br><span class="line">  </span><br><span class="line">// 奔驰SUV</span><br><span class="line">id&lt;YSuvCar&gt; benzSuv = [YBenzCarFactory creatSuvCar];</span><br><span class="line">[benzSuv suvRun];</span><br><span class="line">// 奔驰MPV</span><br><span class="line">id&lt;YMpvCar&gt; benzMpv = [YBenzCarFactory creatMpvCar];</span><br><span class="line">[benzMpv mpvRun];</span><br><span class="line"></span><br><span class="line">// 运行结果：</span><br><span class="line">奥迪SUV跑起来了</span><br><span class="line">奥迪MPV跑起来了</span><br><span class="line">奔驰SUV跑起来了</span><br><span class="line">奔驰MPV跑起来了</span><br></pre></td></tr></table></figure></li></ul><blockquote><p><strong>5、抽象工厂模式与工厂方法模式对比</strong></p></blockquote><table><thead><tr><th>工厂方法模式</th><th>抽象工厂模式</th></tr></thead><tbody><tr><td>工厂类一般只有一个方法，创建一种产品</td><td>工厂类有多个方法，创建多系列产品</td></tr><tr><td>只涉及产品等级</td><td>涉及产品等级与产品族</td></tr><tr><td>增加子类即可添加新产品</td><td>必须修改父类接口才能添加新产品</td></tr></tbody></table><ul><li><a target="_blank" rel="noopener" href="https://github.com/YotrolZ/DesignPatterns-OC">完整Demo</a></li></ul></div><div class="post-copyright"><p class="copyright-item"> <span>Author:</span> <a href="http://yotrolz.com">YotrolZ</a></p><p class="copyright-item"> <span>Link:</span> <a href="http://yotrolz.com/posts/aea66cc7/">http://yotrolz.com/posts/aea66cc7/</a></p><p class="copyright-item"> <span>License:</span> <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a></p></div><footer class="post-footer"><nav class="post-nav"><a class="prev" href="/posts/3fd3799f/"><i class="iconfont icon-left"></i> <span class="prev-text nav-default">设计模式04--建造者模式(iOS)</span> <span class="prev-text nav-mobile">Prev</span></a> <a class="next" href="/posts/5acc72a0/"><span class="next-text nav-default">设计模式02--工厂方法模式(iOS)</span> <span class="prev-text nav-mobile">Next</span><i class="iconfont icon-right"></i></a></nav></footer></article></div><div class="comments" id="comments"></div></div></main><footer id="footer" class="footer"><div class="social-links"></div><div class="copyright"> <span class="power-by">Powered by <a class="hexo-link" target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a></span> <span class="division">|</span> <span class="theme-info">Theme - <a class="theme-link" target="_blank" rel="noopener" href="https://github.com/ahonn/hexo-theme-even">Even</a></span> <span class="copyright-year">&copy;2015 - 2022<span class="heart"><i class="iconfont icon-heart"></i></span> <span class="author">YotrolZ</span></span></div></footer><div class="back-to-top" id="back-to-top"><i class="iconfont icon-up"></i></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/yotrolz/yotrolz.github.io@gh/lib/jquery/jquery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/yotrolz/yotrolz.github.io@gh/lib/slideout/slideout.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/yotrolz/yotrolz.github.io@gh/lib/fancybox/jquery.fancybox.pack.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/yotrolz/yotrolz.github.io@gh/js/src/even.js?v=2.11.0"></script></body></html>